# 用語統一リファクタリング計画

## 概要

ゲーム内の通貨・リソースに関する用語を統一する。

### 変更内容

| 用途 | 旧用語 | 新用語 | 略称 |
|------|--------|--------|------|
| ゲーム内通貨（バトル・通行料・スペル） | 魔力 | エレメントパワー | **EP** |
| ゲーム内総資産 | 総魔力 / 総資産 | トータルエレメントパワー | **TEP** |
| メタゲーム通貨（ガチャ・ショップ） | ゴールド | ゴールド（変更なし） | **G** |
| 支払い金額 | コスト | コスト（変更なし） | - |

### 用語の使い分け

**EP（エレメントパワー）** - ゲームプレイ中の通貨
- クリーチャー召喚コスト
- 通行料の支払い・受け取り
- スペル使用コスト
- レベルアップコスト
- スキルによる獲得・奪取

**TEP（トータルエレメントパワー）** - ゲーム内総資産
- EP + 土地価値 + 魔法石価値
- 勝利条件の判定に使用

**ゴールド（G）** - メタゲーム通貨
- ガチャを引く
- ショップでカードを購入・売却
- クエスト報酬

### 表示例

**ゲーム中:**
```
EP: 1000
TEP: 5000
コスト: 50EP
通行料: 200EP
```

**メニュー・ショップ:**
```
所持ゴールド: 50000G
ガチャ 1回: 300G
```

---

## 進捗状況

### コード変更: ✅ 完了

| 項目 | ステータス | 備考 |
|------|-----------|------|
| JSONデータ `"mp"` → `"ep"` | ✅ 完了 | 既に `"ep"` だった |
| コード内 `get("mp")` → `get("ep")` | ✅ 完了 | 約45箇所 |
| コード内 `mp_cost` → `ep_cost` | ✅ 完了 | 変数名統一 |
| UI表示「魔力」→「EP」 | ✅ 完了 | |
| UI表示「総魔力」→「TEP」 | ✅ 完了 | |
| 単位「G」→「EP」（ゲーム内） | ✅ 完了 | ショップ・ガチャは除く |
| コメント・ログ「魔力」→「EP」 | ✅ 完了 | |
| スキル名「魔力獲得」→「EP獲得」 | ✅ 完了 | |
| スキル名「魔力奪取」→「EP奪取」 | ✅ 完了 | |
| `gold_transfer` → `ep_transfer` | ✅ 完了 | ゲーム内通貨のみ |
| `gold_gained` → `ep_gained` | ✅ 完了 | |
| `legacy_gold` → `legacy_ep` | ✅ 完了 | |

### ドキュメント変更: 🔄 未着手

| 項目 | ステータス | 対象ファイル数 |
|------|-----------|---------------|
| 「魔力」→「EP」 | 未着手 | 30+ファイル |
| 「総魔力」→「TEP」 | 未着手 | ~15ファイル |
| 「G」→「EP」 | 未着手 | 多数 |
| ファイル名変更 | 未着手 | 2ファイル |

---

## 変更対象ドキュメント一覧

### ファイル名変更が必要
- `docs/design/spells/魔力増減.md` → `EP増減.md`
- `docs/design/skills/魔力獲得奪取.md` → `EP獲得奪取.md`

### 内容変更が必要（主要ファイル）
- `docs/design/player_info_panel.md` - UI仕様
- `docs/design/special_tiles.md` - 魔法石・TEP計算
- `docs/design/online_rules_design.md` - 勝利条件
- `docs/design/info_panel.md` - 表示項目
- `docs/design/tutorial_system.md` - チュートリアル
- `docs/design/lap_system.md` - 周回システム
- `docs/design/bankruptcy_system.md` - 破産処理
- `docs/design/mystic_arts.md` - 秘術
- `docs/design/mystic_arts_tasks.md` - 秘術タスク
- `docs/design/spells_tasks.md` - スペルタスク（一部完了）
- `docs/design/creatures_tasks.md` - クリーチャータスク
- `docs/design/item_system.md` - アイテム
- `docs/design/skills_design.md` - スキル設計
- `docs/design/cpu_ai/*.md` - CPU AI関連
- `docs/refactoring/toll_system_refactoring.md` - 通行料リファクタリング

---

## 変更しない項目

### メタゲーム関連（ゴールドのまま）
- `scripts/shop.gd`
- `scripts/main_menu.gd`
- `scripts/gacha_system.gd`
- `scripts/game_data.gd` の `gold` 変数

### クリーチャー・アイテム名
- ゴールドトーテム（ID: 413）
- ゴールドハンマー（ID: 1012）
- ゴールドグース（ID: 1011）

### 変数名（将来の検討事項）
- `magic_power` - 現在は維持、将来的に `ep` への変更を検討

---

## 注意事項

### 2つの通貨システム

このゲームには2つの通貨システムがある：

1. **EP（ゲーム内）** - バトル・土地・スペルで使用
2. **ゴールド（メタゲーム）** - ガチャ・ショップで使用

これらは完全に分離されており、混同しないこと。

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|---------|
| 2026/01/26 | 1.0 | 初版作成 |
| 2026/01/26 | 2.0 | コード変更完了、進捗状況を更新 |

---

**最終更新**: 2026年1月26日
