# プロジェクトロードマップ

**最終更新**: 2026-02-21
**現在地**: アーキテクチャ移行完了、チームシステム実装完了、リリースに向けた準備開始
**方針**: 無料アプリとしてオフライン版を先行リリース。ネット対戦・課金はリリース後に追加。
**サーバー方式**: 案B（Goリレーサーバー + 要所検証）に決定

---

## 全体タスク一覧（36項目）

### リリース前

| # | タスク | カテゴリ | Phase |
|---|--------|---------|-------|
| 1 | SNS開設（X）・開発進捗投稿 | 集客・テスト | P0 |
| 2 | Discord 開設 | 集客・テスト | P0 |
| 3 | テスト配布（itch.io Web版） | 集客・テスト | P0 |
| 4 | テスターフィードバック収集・反映 | 集客・テスト | P0 |
| 5 | カードのリネーム | コンテンツ整備 | P1 |
| 6 | スキル・アルカナアーツのリネーム | コンテンツ整備 | P1 |
| 7 | カードの作成 | コンテンツ制作 | P2 |
| 8 | キャラの作成 | コンテンツ制作 | P2 |
| 9 | クエスト ワールド3-8 作成 | コンテンツ制作 | P2 |
| 10 | ゲーム内エフェクト（VFX） | ビジュアル・サウンド | P2-P3 |
| 11 | BGM / SE / 音楽 | ビジュアル・サウンド | P3 |
| 12 | イラスト・アート | ビジュアル・サウンド | P3 |
| 13 | PV / トレーラー動画 | リリース準備 | P4 |
| 14 | ストア準備（アイコン、スクショ、規約等） | リリース準備 | P4 |
| 15 | 事前登録サイト | リリース準備 | P4 |
| 16 | 多言語対応 | ローカライズ | P4 |
| 17 | アプリの申請（iOS / Android） | リリース | P5 |

### リリース後アップデート

| # | タスク | カテゴリ | Phase |
|---|--------|---------|-------|
| 18 | サーバーレンタル | オンライン機能 | P6 |
| 19 | ネット対戦実装（Go リレーサーバー） | オンライン機能 | P6 |
| 20 | チート対策（要所検証） | オンライン機能 | P6 |
| 21 | アカウント連携（Apple ID / Google） | アカウント基盤 | P7 |
| 22 | データ引き継ぎ・機種変更対応 | アカウント基盤 | P7 |
| 23 | セーブデータのクラウド同期 | アカウント基盤 | P7 |
| 24 | フレンドシステム | ソーシャル機能 | P8 |
| 25 | 通信時コメント（フレンド対戦のみ） | ソーシャル機能 | P8 |
| 26 | レーティング・ランキング | ソーシャル機能 | P8 |
| 27 | 大会システム | ソーシャル機能 | P8 |
| 28 | 観戦機能 | ソーシャル機能 | P8 |
| 29 | SNS共有 | ソーシャル機能 | P8 |
| 30 | 課金システム | マネタイズ | P9 |
| 31 | ガチャの課金対応 | マネタイズ | P9 |
| 32 | ガチャイベント | 運営機能 | P9 |
| 33 | お知らせ機能 | 運営機能 | P9 |
| 34 | お問い合わせ・エラー報告・バグ通報 | 運営機能 | P9 |
| 35 | 特定商取引法に基づく表記 | 運営機能 | P9 |
| 36 | 管理画面（Admin）/ アクセス解析 / プッシュ通知 | 運営機能 | P9 |
| - | コミュニティ運営（Discord / 公式X） | 集客 | P0〜継続 |

---

# リリース前

---

## P0: SNS開設・テスト配布（今すぐ開始）

全作業と並行して継続する。費用ゼロ。

### 0-1. 公式 X アカウント開設

**目的**: 開発の認知度を上げ、テスターとフォロワーを集める

- [ ] X アカウント作成（ゲーム名 or 開発者名）
- [ ] プロフィール設定（ゲーム概要、開発中であること、itch.io リンク）
- [ ] 開発画面のスクショ・短い動画を投稿（週2-3回目安）
- [ ] ハッシュタグ活用: `#ゲーム制作` `#indiegame` `#indiedev` `#godot` `#カードゲーム`
- [ ] 他のインディー開発者をフォロー・交流

**投稿ネタ例**:
- バトル画面のスクショ
- 新カードのデータ紹介
- エフェクト追加のビフォーアフター
- 開発中の苦労話・進捗報告

### 0-2. Discord サーバー開設

**目的**: テスターとのバグ報告・フィードバックのやり取り

- [ ] Discord サーバー作成
- [ ] チャンネル構成:
  - `#お知らせ` — 更新情報（管理者のみ投稿可）
  - `#バグ報告` — テスターからのバグ報告
  - `#要望・感想` — プレイした感想、改善要望
  - `#雑談` — 自由な会話
- [ ] 招待リンク生成（期限なし設定）
- [ ] サーバールール・ガイドライン設定
- [ ] X プロフィールに Discord 招待リンクを掲載

### 0-3. テスト配布（itch.io）

**目的**: テスターにブラウザで遊んでもらう。インストール不要。

- [ ] Godot で Web 版エクスポート（Project → Export → Web）
- [ ] itch.io アカウント作成（https://itch.io）
- [ ] 新規プロジェクト作成 → Web版ファイルをアップロード
- [ ] 公開設定:「Restricted」（URLを知っている人だけ or パスワード制）
- [ ] テスターに URL を共有（Discord / X のDM）
- [ ] X で「テスター募集中」投稿 + Discord 招待リンク

**更新の流れ**:
1. Godot で修正・エクスポート
2. itch.io のプロジェクトページでファイルを差し替え（1分）
3. Discord `#お知らせ` に変更点を投稿
4. テスターがブラウザをリロード → 最新版

### 0-4. フィードバック収集・反映

- [ ] Discord `#バグ報告` を定期確認
- [ ] 報告されたバグの修正
- [ ] UX改善の要望を検討・反映
- [ ] バランス調整（強すぎる/弱すぎるカード等）のフィードバック
- [ ] 対応状況を `#お知らせ` で共有（テスターのモチベーション維持）

---

## P1: コンテンツ整備（名前・データ整理）

P0 と並行して進める。名前が確定しないとイラスト発注や多言語対応に進めない。

### 1-1. カードのリネーム

**対象**: 全カードの名前を最終版に確定する

- [ ] クリーチャーカード名の見直し（242種、5属性）
  - 火属性（49種）: `data/fire_1.json`, `data/fire_2.json`
  - 水属性（48種）: `data/water_1.json`, `data/water_2.json`
  - 地属性（49種）: `data/earth_1.json`, `data/earth_2.json`
  - 風属性（49種）: `data/wind_1.json`, `data/wind_2.json`
  - 無属性（47種）: `data/neutral_1.json`, `data/neutral_2.json`
- [ ] スペルカード名の見直し（132種）: `data/spell_1.json`, `data/spell_2.json`
- [ ] アイテムカード名の見直し: `data/item.json`
- [ ] JSON の `name` フィールド一括更新
- [ ] ゲーム内表示・ログ出力で新名前が正しく反映されることを確認
- [ ] itch.io のテスト版を更新してテスターに確認してもらう

### 1-2. スキル・アルカナアーツのリネーム

**対象**: バトルスキルとアルカナアーツの表示名を最終版に確定する

- [ ] バトルスキル名の見直し（27種）
  - 共鳴、刺突、強化、先制、再生、2回攻撃、即死、反射、無効化、加勢、変身、等
- [ ] アルカナアーツ名の見直し（59種）
  - 各クリーチャー固有のアルカナアーツ名
- [ ] JSON データ更新
  - `ability_parsed` 内のスキル名フィールド
  - アルカナアーツの `name` / `description`
- [ ] コード内のスキル名文字列更新（UI表示、バトルログ用）
- [ ] 設計ドキュメント更新
  - `docs/design/skills_design.md`
  - `docs/design/mystic_arts.md`
  - `docs/design/mystic_arts_tasks.md`

---

## P2: コンテンツ制作（カード・キャラ・クエスト）

P1（リネーム）完了後、またはリネームと並行して進める。

### 2-1. カードの作成

**対象**: 新規スペル・アイテムカードのデータ追加

- [ ] 追加するカードの企画（効果、コスト、レアリティ）
- [ ] 新規スペルカード
  - JSON データ作成（`data/spell_1.json` or `spell_2.json` に追加）
  - `effect_type` の設定
  - SpellEffectExecutor / Strategy パターンでの対応確認
  - CPU AI のスペル評価ロジック対応
- [ ] 新規アイテムカード
  - JSON データ作成（`data/item.json` に追加）
  - `stat_bonus` / `effect_parsed` の設定
  - BattlePreparation / BattleSkillProcessor での処理確認
- [ ] JSON バリデーション（Python スクリプトで構文チェック）
- [ ] テストプレイでバランス確認

### 2-2. キャラの作成

**対象**: 新規クリーチャーのデータ追加

- [ ] 追加するクリーチャーの企画
  - 属性、AP/HP、コスト、レアリティ
  - スキル構成（`ability_parsed`）
  - アルカナアーツ（必要に応じて）
- [ ] JSON データ作成
  - 該当属性ファイルに追加（`fire_1.json` 等）
  - `ability_parsed` にスキル定義
  - アルカナアーツがある場合は `mystic_arts` 設定
- [ ] CPU AI の対応確認
  - 新スキルがある場合は `BattleSkillProcessor` / `ConditionChecker` に実装
  - CPU がカードを適切に使えるか確認
- [ ] テストプレイでバランス確認

### 2-3. クエスト ワールド3-8 作成

**現状**: ワールド1-2 まで作成済み
**参照**: `docs/design/quest_system_design.md`, `docs/design/online_rules_design.md`

| ワールド | テーマ（案） | ステージ数 | マップ | 難易度目安 |
|---------|------------|-----------|--------|----------|
| 3 | - | 未定 | 未定 | 初級〜中級 |
| 4 | - | 未定 | 未定 | 中級 |
| 5 | - | 未定 | 未定 | 中級 |
| 6 | - | 未定 | 未定 | 中級〜上級 |
| 7 | - | 未定 | 未定 | 上級 |
| 8 | - | 未定 | 未定 | 最上級 |

**各ワールドの作成手順**:
1. テーマ・コンセプト決定（どんな敵、どんなルール）
2. マップ作成
   - [ ] マップ JSON（タイル配置、属性、特殊タイル）
   - [ ] 3D 配置座標の設定
   - [ ] チェックポイントプリセット設定
3. ステージ定義
   - [ ] `data/stages/stage_X_Y.json` 作成
   - [ ] CPU 敵の構成（人数、デッキ、AI レベル）
   - [ ] ルールプリセット（勝利条件、目標TEP、ラップボーナス等）
   - [ ] チーム構成（同盟あり/なし）
4. 難易度調整
   - [ ] CPU デッキの強さ調整
   - [ ] 目標TEP の調整
   - [ ] ステージ解放条件の設定
5. テストプレイ
   - [ ] 各ステージをクリアできることを確認
   - [ ] 難易度が適切か確認
   - [ ] ランク判定（SS/S/A/B/C）のバランス確認

---

## P3: ビジュアル・サウンド・エフェクト

P2 と並行作業可能。カード追加と合わせてエフェクトも実装する。

### 3-1. ゲーム内エフェクト（VFX）

カード・スキル追加と並行して対応するエフェクトも実装する。

**バトル系**:
- [ ] 通常攻撃エフェクト（斬撃、打撃等）
- [ ] スキル発動エフェクト（先制、強化、即死、反射、再生、2回攻撃等）
- [ ] ダメージ表示（数字ポップアップ）
- [ ] 撃破エフェクト
- [ ] 勝利/敗北演出

**スペル系**:
- [ ] スペル発動エフェクト（属性別: 炎、氷、風、土等）
- [ ] 刻印付与/解除エフェクト
- [ ] バフ/デバフ表示
- [ ] ワールド刻印発動エフェクト

**フィールド系**:
- [ ] 召喚エフェクト
- [ ] ダイスロール演出
- [ ] 移動・ワープエフェクト
- [ ] レベルアップエフェクト
- [ ] 周回完了エフェクト

**素材調達**:
- [ ] 調達方法決定（自作 / Godot アセットライブラリ / 外注）
- [ ] Godot の GPUParticles3D / CPUParticles3D で実装

### 3-2. BGM / SE / 音楽

- [ ] 調達方法決定（自作 / 外注 / フリー素材）
  - フリー素材サイト例: DOVA-SYNDROME、魔王魂、甘茶の音楽工房
- [ ] メインメニューBGM
- [ ] マップ/フィールドBGM
- [ ] バトルBGM
- [ ] 勝利ジングル
- [ ] 敗北ジングル
- [ ] 効果音
  - カード選択 / カード配置
  - ダイスロール
  - 攻撃ヒット / ダメージ
  - スペル発動
  - レベルアップ / 周回完了
  - UI操作音（ボタンタップ、画面遷移）
- [ ] Godot AudioStreamPlayer での再生実装
- [ ] 音量設定UI（BGM / SE 個別調整）

### 3-3. イラスト・アート

- [ ] 調達方法決定（自作 / 外注 / AI生成）
  - 外注先例: ココナラ、SKIMAなど
  - AI生成: Stable Diffusion、Midjourney等
- [ ] クリーチャーイラスト（242種）
  - カードフレーム内に収まるサイズ
  - 属性ごとの雰囲気統一
- [ ] スペルカードイラスト（132種）
- [ ] アイテムカードイラスト
- [ ] ゲームロゴ
- [ ] アプリアイコン（1024×1024、ストア用）
- [ ] UIデザイン素材（ボタン、パネル、背景等）
- [ ] Godot への組み込み（TextureRect / Sprite3D）

---

## P4: リリース準備

P2/P3 のコンテンツ・ビジュアルが揃った後に着手。

### 4-1. ストア準備

**iOS (App Store)**:
- [ ] Apple Developer Program 登録（$99/年）
- [ ] App Store Connect でアプリ情報入力
- [ ] アプリアイコン（1024×1024）
- [ ] スクリーンショット撮影
  - iPhone 6.7インチ用（1290×2796）× 5-8枚
  - iPad 12.9インチ用（2048×2732）× 5-8枚
- [ ] アプリ説明文（日本語）
- [ ] カテゴリ選択（ゲーム → カード / ボード / ストラテジー）
- [ ] 年齢レーティング質問回答

**Android (Google Play)**:
- [ ] Google Play Console 登録（$25 一回）
- [ ] ストアの掲載情報入力
- [ ] アプリアイコン（512×512）
- [ ] フィーチャーグラフィック（1024×500）
- [ ] スクリーンショット（16:9 or 9:16）× 4-8枚
- [ ] アプリ説明文（日本語）
- [ ] コンテンツレーティング質問回答

**共通**:
- [ ] 利用規約の作成
- [ ] プライバシーポリシーの作成（個人情報を収集しない場合でも必要）
- [ ] 掲載用 Web ページにホスティング（GitHub Pages 等、無料）

### 4-2. PV / トレーラー動画

**目的**: ストアページ、事前登録サイト、X で使用

- [ ] 制作方法決定（自作 / 外注）
  - 自作の場合: OBS Studio（録画）+ DaVinci Resolve（編集、無料）
- [ ] ゲームプレイ映像の撮影
  - バトルシーン（スキル発動、エフェクト）
  - マップ移動（3D ボード）
  - カード選択・召喚シーン
  - スペル発動
- [ ] BGM / テロップ付きで編集
- [ ] 30秒版（X / SNS 用）
- [ ] 1-2分版（ストアページ用）
- [ ] YouTube にアップロード → ストアページ・X に掲載

### 4-3. 事前登録サイト

**目的**: リリース前にユーザーを集める

- [ ] ランディングページ作成（GitHub Pages / Netlify、無料）
  - ゲーム紹介文
  - スクリーンショット / PV 動画埋め込み
  - 事前登録フォーム（Google Forms で十分）
  - Discord 招待リンク
  - X アカウントリンク
- [ ] 事前登録特典の企画（限定カード、ガチャ石等）
- [ ] X で事前登録開始を告知

### 4-4. 多言語対応

**対応言語**: 日本語（メイン）+ 英語

- [ ] Godot の TranslationServer 設定
- [ ] 翻訳キー方式への移行
  - ハードコード文字列 `"バトル開始"` → `tr("BATTLE_START")`
  - 対象: UI テキスト、メッセージ、ボタンラベル、ダイアログ
- [ ] 翻訳ファイル作成（CSV 形式）
  ```
  key,ja,en
  BATTLE_START,バトル開始,Battle Start
  SPELL_PHASE,スペルフェーズ,Spell Phase
  ```
- [ ] カード名・スキル名の英語翻訳
- [ ] カード説明文・フレーバーテキストの翻訳
- [ ] ストア説明文の英語版作成
- [ ] 言語切替 UI（設定画面）

---

## P5: アプリ申請・リリース

### 5-1. ビルド

- [ ] Godot エクスポート設定
  - Android: APK / AAB ビルド、署名鍵生成
  - iOS: Xcode プロジェクトエクスポート → Xcode でビルド
- [ ] リリースビルド作成（デバッグ情報除去）
- [ ] 最終動作確認（実機テスト）

### 5-2. 申請

| プラットフォーム | 必要なもの | 審査期間 |
|----------------|-----------|---------|
| iOS (App Store) | Apple Developer Program ($99/年)、Xcode、Mac | 1-7日 |
| Android (Google Play) | Google Play Console ($25 一回)、署名鍵 | 数時間-3日 |

- [ ] App Store Connect にビルドアップロード → 審査提出
- [ ] Google Play Console にビルドアップロード → 審査提出
- [ ] 審査結果確認
- [ ] リジェクトされた場合の対応・再提出

### 5-3. リリース日

- [ ] X / Discord で事前告知（リリース日の1週間前）
- [ ] 事前登録者へ通知
- [ ] ストアで公開 → X / Discord で告知
- [ ] itch.io のテスト版を正式版ストアリンクに差し替え

---

# リリース後アップデート

---

## P6: ネット対戦・サーバー

**方式**: 案B（Go リレーサーバー + 要所検証）
**設計ドキュメント**: `docs/design/network_design.md`
**技術的リスク**: 最大（既存 GFM のネットワーク対応が必要）

### 6-1. サーバーレンタル・DB設計

| サービス | 最安プラン | 特徴 |
|---------|-----------|------|
| さくらVPS | 月643円〜 | 国内、日本語サポート |
| ConoHa | 月296円〜 | 国内、時間課金あり |
| Vultr | 月$2.5〜 | 海外、安い |

- [ ] サービス選定・契約
- [ ] VPS 初期設定（OS、ファイアウォール、SSL）
- [ ] ドメイン取得（必要に応じて）
- [ ] **DB 全体設計**（P7〜P9 で必要なテーブルも含めて先に設計）
  ```
  users          - ユーザーアカウント（P6）
  match_history  - 対戦履歴（P6）
  decks          - 対戦用デッキ（P6）
  friends        - フレンドリスト（P8）
  rankings       - レーティング（P8）
  tournaments    - 大会データ（P8）
  purchases      - 課金履歴（P9）
  announcements  - お知らせ（P9）
  cloud_saves    - セーブデータ（P7）
  push_tokens    - プッシュ通知トークン（P9）
  ```

### 6-2. Go リレーサーバー実装

- [ ] Go 開発環境構築
- [ ] WebSocket サーバー基盤（gorilla/websocket 等）
- [ ] 接続管理（プレイヤー接続・切断・再接続）
- [ ] メッセージ転送（JSON over WebSocket）
- [ ] 要所検証ロジック
  - ダイスはサーバー側で生成（チート防止）
  - EP 残高チェック
  - 手札所持チェック
  - ターン順の検証
- [ ] VPS にデプロイ
- [ ] **ゴール**: 2台の端末でメッセージ送受信

### 6-3. ロビー・マッチング

- [ ] 部屋作成 API（`create_room`）
- [ ] 部屋参加 API（`join_room`）
- [ ] 部屋一覧 API（`list_rooms`）
- [ ] 準備完了 → ゲーム開始の流れ
- [ ] ロビー UI（クライアント側 GDScript）
  - 部屋一覧画面
  - 部屋作成ダイアログ
  - 待機画面（参加者表示）
- [ ] **ゴール**: ロビーで部屋を作って相手と合流

### 6-4. ターン同期

**最大の技術的リスク**: 既存 GameFlowManager の全フェーズにネットワーク分岐を追加

- [ ] `player_is_remote` フラグ追加（PlayerSystem）
- [ ] 各フェーズの操作送受信:
  - スペル選択 → SpellPhaseHandler
  - ダイス結果 → DicePhaseHandler（サーバーから受信）
  - 移動方向選択 → MovementController
  - 召喚カード選択 → TileActionProcessor
  - バトルアイテム選択 → BattleSystem
  - ドミニオコマンド → DominioCommandHandler
- [ ] ローカルプレイヤー: 操作をサーバーに送信
- [ ] リモートプレイヤー: サーバーからの結果を受信 → 画面に反映
- [ ] オフライン（CPU対戦）は今まで通り動くことを確認
- [ ] **ゴール**: 2人でオンライン対戦が成立

### 6-5. 安定化

- [ ] 回線切断検知 → 60秒待機 → AI 引き継ぎ
- [ ] ターンタイムアウト（60秒で自動パス）
- [ ] 対戦結果の DB 保存
- [ ] ユーザー認証（ログイン / 登録）
- [ ] 対戦中の異常終了ハンドリング

### 6-6. チート対策（段階的強化）

| 段階 | 検証内容 | タイミング |
|------|---------|-----------|
| 初期 | ターン順、手札所持、EP残高、ダイス（サーバー生成） | P6リリース時 |
| 中期 | バトル結果の妥当性チェック（HP範囲、ダメージ範囲） | 不正報告が出たら |
| 後期 | バトルロジック完全再現 | 必要に応じて（やらなくても可） |

- [ ] 通信データの暗号化（WSS: WebSocket Secure）
- [ ] 不正検知ログ
- [ ] BAN 機能（管理画面連携）

---

## P7: アカウント基盤・データ保全

**課金（P9）より先に実装する**。課金後にデータが飛ぶのを防ぐ。

### 7-1. アカウント連携（Apple ID / Google）

- [ ] Apple Sign In 対応（iOS アプリで SNS ログインを提供する場合は Apple が必須）
- [ ] Google Sign In 対応
- [ ] Go サーバー側の OAuth トークン検証
- [ ] 連携済みアカウントの自動ログイン
- [ ] 複数端末での同一アカウント利用
- [ ] 未連携ユーザーのゲスト → アカウント連携フロー

### 7-2. データ引き継ぎ・機種変更対応

- [ ] 引き継ぎコード発行（設定画面 → 16桁コード生成）
- [ ] 引き継ぎコード入力 → サーバー照合 → データ復元
- [ ] 引き継ぎ UI（設定画面内）
- [ ] 引き継ぎ完了後、旧端末データの無効化
- [ ] アカウント連携済みなら引き継ぎコード不要（自動復元）

### 7-3. セーブデータのクラウド同期

- [ ] セーブデータの構造定義（所持カード、デッキ、ゴールド、クエスト進捗等）
- [ ] サーバーへの自動アップロード（ゲーム終了時 / 重要操作時）
- [ ] 端末起動時の同期チェック（ローカル vs クラウドの比較）
- [ ] 競合解決 UI（「サーバーのデータを使う / 端末のデータを使う」選択）
- [ ] データ復旧フロー（端末故障時、新端末からログインで復元）

---

## P8: ソーシャル機能

### 8-1. フレンドシステム

- [ ] フレンド申請（ユーザーID or QRコード）
- [ ] 申請承認 / 拒否
- [ ] フレンド削除
- [ ] フレンドリスト表示（オンライン/オフライン状態）
- [ ] フレンド対戦の招待 → マッチング
- [ ] Go サーバー: friends テーブル操作 API

### 8-2. 通信時コメント（フレンド対戦のみ）

フレンド対戦のみコメント可能。ランダム対戦・大会ではコメント・スタンプ一切なし。
（UGC を最小限にし、ストア審査・監視コストを軽減）

- [ ] 定型コメント / スタンプのデータ定義（20-30種）
- [ ] 対戦中のコメント送受信（WebSocket 経由）
- [ ] コメント表示 UI（画面上のトースト / 吹き出し、数秒で消える）
- [ ] フレンド対戦時のみ有効化する制御フラグ

### 8-3. レーティング・ランキング

- [ ] レーティングアルゴリズム選定（Elo / Glicko-2）
- [ ] 対戦結果に基づくレーティング更新（Go サーバー側）
- [ ] ランキング表示 UI
  - 全体ランキング（Top 100）
  - フレンド内ランキング
- [ ] シーズン制（例: 月次リセット、シーズン報酬）
- [ ] Go サーバー: rankings テーブル操作 API

### 8-4. 大会システム

- [ ] 大会形式の決定（トーナメント / リーグ / スイスドロー）
- [ ] 大会作成・参加フロー
- [ ] トーナメント表 / リーグ表 UI
- [ ] 対戦組み合わせの自動生成
- [ ] 大会結果・報酬配布
- [ ] 定期開催スケジュール管理

### 8-5. 観戦機能

ネット対戦（P6）の延長で比較的軽量に実装可能（1-2週間）。

- [ ] Go サーバー: spectator 接続タイプ追加（操作入力を受け付けない受信専用）
- [ ] クライアント: 観戦モード UI（操作ボタン非表示、両者のボード表示）
- [ ] 観戦中の情報制限（手札は非公開）
- [ ] フレンドリストから「観戦する」ボタン

### 8-6. SNS 共有

- [ ] 対戦結果のシェア画像生成（Godot の Viewport → Image → PNG）
- [ ] X / LINE 等への共有機能（OS のシェアシート連携）
- [ ] レアカード入手時のシェア
- [ ] ディープリンク（シェアURLからアプリ起動 / ストアページへ誘導）

---

## P9: マネタイズ・運営機能

### 9-1. 課金システム

- [ ] 課金アイテム設計
  - ガチャ石（有償通貨）
  - 価格帯: 120円 / 370円 / 610円 / 1,220円 / 3,060円 等
- [ ] ストア API 連携
  - iOS: StoreKit 2
  - Android: Google Play Billing Library
- [ ] Go サーバー: レシート検証 API（Apple / Google それぞれ）
- [ ] 購入履歴管理（purchases テーブル）
- [ ] 課金 UI（ショップ画面）
- [ ] ストア手数料（30%）を考慮した価格設定

### 9-2. ガチャの課金対応

現在のガチャはゲーム内ゴールドのみ。有償通貨を追加する。

- [ ] 有償通貨（ガチャ石）の設計
  - 無償石（クエスト報酬等）と有償石（課金）の区別
- [ ] ガチャ石で引けるガチャ UI
- [ ] ゴールドガチャ / 石ガチャ の使い分け UI
- [ ] 天井（ピティ）システム（例: 300連で確定）
- [ ] 確率表示（日本: 景品表示法、海外: ストア規約）

### 9-3. ガチャイベント

- [ ] ピックアップガチャ（特定カードの排出率UP）
- [ ] イベント期間管理（Go サーバーから開始/終了日時を配信）
- [ ] イベントガチャ UI（バナー表示、期間カウントダウン）
- [ ] イベント限定カード対応
- [ ] ガチャ履歴・天井カウントの表示

### 9-4. 特定商取引法に基づく表記

アプリ内課金がある場合、日本では法律で表示義務あり。テンプレート通りに書くだけ。

- [ ] 販売業者名（個人名 or 屋号）
- [ ] 連絡先（メールアドレス）
- [ ] 販売価格（ガチャ石の価格一覧）
- [ ] 支払方法（App Store / Google Play 経由）
- [ ] 返品・キャンセルについて（デジタルコンテンツのため原則不可）
- [ ] アプリ内 or Web ページに掲載

### 9-5. お知らせ機能

- [ ] Go サーバー: お知らせ API（CRUD）
- [ ] クライアント: 起動時にお知らせ取得
- [ ] お知らせ一覧 UI
- [ ] 未読管理（バッジ表示）
- [ ] メンテナンス告知対応（強制表示）
- [ ] イベント告知・期間限定コンテンツ

### 9-6. お問い合わせ・エラー報告・バグ通報

- [ ] アプリ内お問い合わせフォーム
  - カテゴリ選択（不具合 / バランス / 要望 / その他）
  - 自由入力テキスト
- [ ] 端末情報の自動添付（OS、アプリバージョン、端末モデル、現在のステージ）
- [ ] 送信先: 運営メールアドレス or Go サーバー経由で DB 保存
- [ ] 送信完了確認 UI（「送信しました」トースト）

### 9-7. 管理画面（Admin）

ブラウザから運営操作を行う Web ツール。Go サーバーが API を提供。

- [ ] 技術選定（Go テンプレート / React / Vue 等）
- [ ] ユーザー管理（検索、詳細確認、BAN）
- [ ] お知らせ投稿・編集
- [ ] ガチャイベント設定・管理（期間、排出率）
- [ ] バグ報告の閲覧・対応ステータス管理
- [ ] ゲーム内データ確認（カード、ステージ等）

### 9-8. アクセス解析（Analytics）

- [ ] 導入方法決定
  - Firebase Analytics（無料、推奨）: DAU/MAU、課金率、離脱ポイント
  - 自前: Go サーバーにイベントログ保存
- [ ] トラッキングイベント定義
  - DAU / MAU
  - 課金率・ARPU
  - ステージ別クリア率・離脱ポイント
  - ガチャ利用状況
  - 対戦回数・勝率分布
- [ ] Godot クライアントからイベント送信

### 9-9. プッシュ通知

- [ ] FCM（Firebase Cloud Messaging）導入
- [ ] Go サーバー: FCM 送信 API
- [ ] 通知種別:
  - フレンド対戦招待
  - イベント開始・終了
  - メンテナンス告知
  - 長期間未ログインのリテンション通知
- [ ] 通知設定 UI（ON/OFF 切替、種別ごと）
- [ ] push_tokens テーブルでトークン管理

---

## 補足: 技術的に残っている項目（優先度低）

| 項目 | 内容 |
|------|------|
| 残存スペル 3-6個 | ボンドオブラバーズ、ハングドマンズシール、ハーミットズパラドックス等 |
| 分岐マップ | マップの多様性向上 |
| UI チームカラー | PlayerInfoPanel のチーム色表示 |
| CPU AI 強化 | 複数ターン先読み、難易度別AI |
| DB移行 | SQLite完全移行、スケール対応 |
| バトルテストツール | スペルテスト、CSV出力 |

---

## 優先順位フロー

```
【リリース前】

P0: SNS開設・テスト配布（itch.io + Discord） ─── 全期間並行
 +
P1: リネーム（カード・スキル名確定）
 +                                              ← P1〜P3 は並行作業
P2: コンテンツ制作（カード・キャラ・クエスト W3-8・エフェクト）
 +
P3: ビジュアル・サウンド（BGM/SE・イラスト）
 ↓
P4: リリース準備（ストア・PV・事前登録・多言語）
 ↓
P5: アプリ申請（無料・課金なし）

======= リリース =======

【リリース後アップデート】

P6:  ネット対戦（Go リレーサーバー・チート対策）  ← 最大の技術的リスク
 ↓
P7:  アカウント基盤（データ引き継ぎ・クラウド同期）← 課金より先
 ↓
P8:  ソーシャル（フレンド・ランキング・大会・観戦・SNS共有）
 ↓
P9:  マネタイズ・運営（課金・ガチャイベント・お知らせ・管理画面）
```

---

## 決定事項メモ

| 項目 | 決定内容 | 日付 |
|------|---------|------|
| サーバー方式 | 案B: Go リレーサーバー + 要所検証 | 2026-02-21 |
| リリース形態 | 無料アプリ（課金なし）で先行リリース | 2026-02-21 |
| ネット対戦 | リリース後アップデートで追加 | 2026-02-21 |
| 課金 | リリース後、アカウント基盤の後に追加 | 2026-02-21 |
| コメント | フレンド対戦のみ。ランダム・大会はなし | 2026-02-21 |
| テスト配布 | itch.io（Web版、無料）+ Discord でフィードバック | 2026-02-21 |
| テスト時バグ報告 | Discord で十分。アプリ内報告はユーザー増加後 | 2026-02-21 |
| 想定ユーザー規模 | 500-700人（VPS 2-3台で対応可能） | 2026-02-21 |
| サーバーレンタル時期 | P6（リリース後）。テスト配布は itch.io で無料 | 2026-02-21 |
