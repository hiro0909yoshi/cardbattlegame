# スペル借用効果

**実装完了**: 2025年12月2日

---

## 概要

手札のスペルカードや他クリーチャーの秘術を「借りて」使用する効果。

---

## 対象カード

| ID | 名前 | 種別 | コスト | 効果 |
|----|------|------|--------|------|
| 147 | ルーンアデプト | 秘術 | G100 | 手札の単体対象スペルの効果を使用（カード消費なし） |
| 2059 | テンプテーション | スペル | G70 + カード1枚 | 対象クリーチャーの秘術を使用（コスト無料） |

---

## ルーンアデプト（ID 147）

### 仕様

- 手札にある「単体対象」スペルを1枚選択し、その効果を発動
- 秘術コスト100Gのみ支払い
- **選択したスペルのコストは不要**
- **カードは消費されず手札に残る**
- 手札に単体対象スペルがない場合は秘術使用不可

### 処理フロー

1. 秘術発動 → スペル選択UI表示
2. 単体対象スペルを選択
3. 選択スペルのターゲットを選択
4. 効果適用
5. 100G消費

---

## テンプテーション（ID 2059）

### 仕様

- 秘術を持つクリーチャーを対象に選択
- 対象の秘術を自分が発動者として使用
- スペルコスト（70G + カード1枚）のみ支払い
- **秘術のコストは無料**
- 対象は敵・味方どちらも可
- ダウンしているクリーチャーは対象不可
- **ルーンアデプトの「スペル借用」は使用不可**

### 処理フロー

1. スペル発動 → 秘術持ちクリーチャーを選択
2. 対象の秘術を選択（複数ある場合）
3. 秘術のターゲットを選択（必要な場合）
4. 効果適用

---

## 実装ファイル

| ファイル | 役割 |
|----------|------|
| `scripts/spells/spell_borrow.gd` | SpellBorrowクラス（両効果の処理） |
| `scripts/game_flow/spell_phase_handler.gd` | effect_type呼び出し |
| `scripts/game_flow/target_selection_helper.gd` | ターゲットフィルター |

### effect_type

| 値 | 説明 |
|----|------|
| `use_hand_spell` | 手札スペルの効果を使用（ルーンアデプト） |
| `use_target_mystic_art` | 対象の秘術を使用（テンプテーション） |

---

## JSON定義例

### ルーンアデプト（ability_parsed内）

```json
"mystic_arts": [{
  "name": "スペル借用",
  "cost": 100,
  "target_type": "self",
  "effects": [{ "effect_type": "use_hand_spell" }]
}]
```

### テンプテーション（effect_parsed）

```json
"effect_parsed": {
  "target_type": "creature",
  "target_info": {
    "owner_filter": "any",
    "require_mystic_arts": true,
    "require_not_down": true
  },
  "effects": [{ "effect_type": "use_target_mystic_art" }]
}
```
