# ç¥ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ´—ã„å‡ºã—ãƒ¬ãƒãƒ¼ãƒˆ

**åˆ†ææ—¥**: 2026-02-14
**å¯¾è±¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: ã‚«ãƒ«ãƒ‰ã‚»ãƒ—ãƒˆé¢¨ã‚«ãƒ¼ãƒ‰ãƒãƒˆãƒ«ã‚²ãƒ¼ãƒ  (Godot 4.4.1)
**ã‚³ãƒ¼ãƒ‰è¡Œæ•°**: ç´„87,600è¡Œ

---

## 1. æ¤œå‡ºã•ã‚ŒãŸç¥ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§

### ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°çµæœã‚µãƒãƒªãƒ¼

| ã‚¯ãƒ©ã‚¹ | è¡Œæ•° | è²¬å‹™æ•° | è¢«ä¾å­˜ | ä¾å­˜ | ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¹ã‚³ã‚¢ | è©•ä¾¡ |
|--------|------|--------|--------|------|---------|--------|------|
| **UIManager** | 1,069 | 10+ | 89 | 15+ | 93 | **66ç‚¹** | ğŸ”´é‡åº¦ |
| **BoardSystem3D** | 1,031 | 12+ | 82 | 25+ | 111 | **63ç‚¹** | ğŸ”´é‡åº¦ |
| **SpellPhaseHandler** | 1,764 | 11+ | 60+ | 30+ | 80 | **64ç‚¹** | ğŸ”´é‡åº¦ |
| **DominioCommandHandler** | 1,227 | 9+ | 50+ | 20+ | 73 | **58ç‚¹** | ğŸŸ¡ä¸­åº¦ |
| **GameFlowManager** | 739 | 8+ | 80 | 20+ | 43 | **56ç‚¹** | ğŸŸ¡ä¸­åº¦ |
| **BattleExecution** | 1,006 | 6+ | 40 | 15 | 35 | **42ç‚¹** | ğŸŸ¡ä¸­åº¦ |
| **BattleSpecialEffects** | 1,108 | 7+ | 35 | 20 | 40 | **43ç‚¹** | ğŸŸ¡ä¸­åº¦ |

---

## 2. å„ç¥ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®è©³ç´°åˆ†æ

### ğŸ”´ UIManagerï¼ˆ1,069è¡Œã€ã‚¹ã‚³ã‚¢: 66ç‚¹ï¼‰

**åŸºæœ¬æƒ…å ±**
- **è¡Œæ•°**: 1,069è¡Œ
- **ãƒ¡ã‚½ãƒƒãƒ‰æ•°**: 93å€‹
- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ•°**: 18å€‹
- **è²¬å‹™æ•°**: 10+å€‹
- **è¢«ä¾å­˜**: 89ç®‡æ‰€
- **ä¾å­˜**: 15å€‹ä»¥ä¸Šã®ã‚·ã‚¹ãƒ†ãƒ 

**ä¸»ãªè²¬å‹™**
1. UIè¦ç´ ã®çµ±æ‹¬ç®¡ç†ï¼ˆå…¨ã‚²ãƒ¼ãƒ ç”»é¢ã®ä¸­å¤®é›†ç´„ï¼‰
2. æ‰‹æœ­UIç®¡ç†ï¼ˆHandDisplayå§”è­²ï¼‰
3. ã‚«ãƒ¼ãƒ‰é¸æŠUIç®¡ç†
4. ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—UIç®¡ç†
5. ãƒ‡ãƒãƒƒã‚°ãƒ‘ãƒãƒ«ç®¡ç†
6. ãƒ•ã‚§ãƒ¼ã‚ºè¡¨ç¤ºç®¡ç†ï¼ˆPhaseDisplayå§”è­²ï¼‰
7. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±ãƒ‘ãƒãƒ«ç®¡ç†
8. ã‚¤ãƒ³ãƒ•ã‚©ãƒ‘ãƒãƒ«ç®¡ç†ï¼ˆCreature/Spell/Itemï¼‰
9. ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ç®¡ç†
10. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç†ï¼ˆsave/restoreï¼‰

**ä¾å­˜é–¢ä¿‚ï¼ˆãƒãƒ–åŒ–ï¼‰**
```
UIManager â†’ {
  HandDisplay, PhaseDisplay, CardSelectionUI, LevelUpUI,
  DebugPanel, PlayerInfoPanel, CreatureInfoPanelUI,
  SpellInfoPanelUI, ItemInfoPanelUI, GlobalCommentUI,
  GlobalActionButtons, DominioOrderUI, TapTargetManager,
  UIWinScreen, UITapHandler, UIGameMenuHandler
}
```

**è¢«ä¾å­˜ï¼ˆå¤šæ•°ã®ã‚¯ãƒ©ã‚¹ã‹ã‚‰å‚ç…§ï¼‰**
- game_flow_manager, board_system_3d, battle_system
- spell_phase_handler, dominio_command_handler
- CardSelectionUI, BattleScreenç³»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- CPU AIå„ç¨®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

**å•é¡Œç‚¹**
- **ãƒ•ã‚¡ã‚µãƒ¼ãƒ‰åŒ–**: UIå…¨ä½“ã®é–¢é–€ã«ãªã‚Šã™ãã¦ã„ã‚‹
  - æ‰‹æœ­è¡¨ç¤ºã‹ã‚‰æˆ¦é—˜ç”»é¢ã¾ã§å…¨ã¦ UIManager ã‚’çµŒç”±
  - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ•°ãŒ18å€‹ã¨å¤šãã€å„ç¨®å‚ç…§ã‚’ä¿æŒ

- **è²¬å‹™ã®å¤šé‡æ€§**: UIç®¡ç†è€…ã¨ã„ã†ã‚ˆã‚Šã€ŒUIä¸‡èƒ½è€…ã€
  - è¡¨ç¤º/éè¡¨ç¤ºåˆ¶å¾¡ã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†ã€ãƒœã‚¿ãƒ³ç®¡ç†ãªã©å…¨ã¦
  - æ–°ã—ã„UIè¦ç´ è¿½åŠ ã®ãŸã³ã« UIManager ãŒè‚¥å¤§åŒ–

- **å¤‰æ›´é »åº¦**: é€±1å›ä»¥ä¸Šã®ä¿®æ­£ï¼ˆæœ€è¿‘ã®ã‚³ãƒŸãƒƒãƒˆå±¥æ­´ï¼‰
  - Task #5: Signal æ¥ç¶šé‡è¤‡ãƒã‚§ãƒƒã‚¯å®Œå…¨åŒ–
  - Task #3: Optionalå‹æ³¨é‡ˆã‚’è¿½åŠ 

**æ¨å¥¨æ”¹å–„**
1. **UIå±¤ã®æ§‹é€ åŒ–**: CanvasLayerå˜ä½ã§ã®UIã‚¹ã‚³ãƒ¼ãƒ—åˆ†å‰²
2. **è²¬å‹™åˆ†é›¢**:
   - UIState ãƒã‚·ãƒ³åŒ–ï¼ˆæ‰‹æœ­UIã€æˆ¦é—˜UIã€ãƒ‰ãƒŸãƒ‹ã‚ªUIï¼‰
   - å„ãƒ•ã‚§ãƒ¼ã‚ºã”ã¨ã®UIã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼åˆ†é›¢
3. **Facade ãƒ‘ã‚¿ãƒ¼ãƒ³æ”¹å–„**: å®Ÿè£…è€…å‘ã‘ã®ç´°ç²’åº¦APIã‚’æä¾›
4. **ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•**: UIé–“é€šä¿¡ã‚’ã‚·ã‚°ãƒŠãƒ«åŒ–

---

### ğŸ”´ BoardSystem3Dï¼ˆ1,031è¡Œã€ã‚¹ã‚³ã‚¢: 63ç‚¹ï¼‰

**åŸºæœ¬æƒ…å ±**
- **è¡Œæ•°**: 1,031è¡Œ
- **ãƒ¡ã‚½ãƒƒãƒ‰æ•°**: 111å€‹ï¼ˆæœ€å¤šï¼‰
- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ•°**: 15å€‹
- **è²¬å‹™æ•°**: 12+å€‹
- **è¢«ä¾å­˜**: 82ç®‡æ‰€
- **ä¾å­˜**: 25å€‹ä»¥ä¸Šã®ã‚·ã‚¹ãƒ†ãƒ 

**ä¸»ãªè²¬å‹™**
1. 3Dãƒœãƒ¼ãƒ‰ç®¡ç†ï¼ˆã‚¿ã‚¤ãƒ«é…ç½®ãƒ»ç®¡ç†ï¼‰
2. ã‚¿ã‚¤ãƒ«ãƒ‡ãƒ¼ã‚¿ç®¡ç†ï¼ˆTileDataManagerã«éƒ¨åˆ†å§”è­²ï¼‰
3. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç§»å‹•åˆ¶å¾¡ï¼ˆMovementController3Dã«å§”è­²ï¼‰
4. ã‚¿ã‚¤ãƒ«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ï¼ˆTileActionProcessorã«å§”è­²ï¼‰
5. ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼é…ç½®ãƒ»å‰Šé™¤ãƒ»æ›´æ–°
6. ã‚¹ã‚­ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç®¡ç†ï¼ˆå¿œæ´ãƒ»ä¸–ç•Œå‘ªå¯¾å¿œï¼‰
7. åœ°å½¢å¤‰åŒ–ã‚·ã‚¹ãƒ†ãƒ 
8. ãƒ¯ãƒ¼ãƒ—ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†
9. ã‚«ãƒ¡ãƒ©åˆ¶å¾¡ï¼ˆCameraControllerã¸ã®ãƒãƒ–ï¼‰
10. CPUå‡¦ç†ï¼ˆCPUTurnProcessorã«å§”è­²ï¼‰
11. éš£æ¥ã‚¿ã‚¤ãƒ«åˆ¤å®šï¼ˆTileNeighborSystemã«å§”è­²ï¼‰
12. ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ï¼ˆã‚¹ã‚­ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¡¨ç¤ºç­‰ï¼‰

**ä¾å­˜é–¢ä¿‚**
```
BoardSystem3D â†’ {
  TileDataManager, MovementController3D, TileActionProcessor,
  TileNeighborSystem, TileInfoDisplay, CPUTurnProcessor,
  CameraController, PlayerSystem, CardSystem, BattleSystem,
  UIManager, GameFlowManager, SpellLand (ç›´æ¥å‚ç…§)
}

Created instances (15+):
- tile_nodes[Dict], player_nodes[Array], subsystems
```

**è¢«ä¾å­˜ï¼ˆãƒãƒ–åŒ–ï¼‰**
- GameFlowManager, BattleSystem, UIManager
- MovementController, TileActionProcessor
- CPUAIHandler, CPUMovementEvaluator
- TutorialManager, CameraController

**å•é¡Œç‚¹**
- **ãƒ¡ã‚½ãƒƒãƒ‰æ•°ãŒå¤šã„**: 111å€‹ã¯è¨­è¨ˆã‹ã‚‰å¤–ã‚Œã¦ã„ã‚‹
  - åŸå› : å„ã‚µãƒ–ã‚·ã‚¹ãƒ†ãƒ ã¸ã®å§”è­²ãƒ¡ã‚½ãƒƒãƒ‰ã®é›†ç´„ï¼ˆ60å€‹ä»¥ä¸ŠãŒå§”è­²ãƒ¡ã‚½ãƒƒãƒ‰ï¼‰
  - Facadeçš„ãªå­˜åœ¨ã«ãªã£ã¦ã„ã‚‹ãŒã€å®Ÿè£…ãŒç´°ç²’åº¦ã™ãã‚‹

- **äºŒé‡ç®¡ç†ã®å±é™ºæ€§**:
  - tile_nodes[Dict] ã¨ TileDataManager ã®åŒæœŸ
  - creature_data ã® SSoT å•é¡Œï¼ˆCreatureManager, BaseTile, TileDataManager ã®3ç®‡æ‰€ã«å­˜åœ¨ï¼‰

- **è²¬å‹™ã®æ›–æ˜§æ€§**:
  - BoardSystem3D ãŒ ä½•ã‹ã®ã€Œçµ±åˆè€…ã€ãªã®ã‹ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€ãªã®ã‹ä¸æ˜ç¢º
  - ç›´æ¥å‚ç…§ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆspell_landï¼‰ã¨å§”è­²ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒæ··åœ¨

- **å¤‰æ›´é »åº¦**: ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ ã®ãŸã‚é »ç¹ã«ä¿®æ­£

**æ¨å¥¨æ”¹å–„**
1. **ãƒ‡ãƒ¼ã‚¿å±¤ã®çµ±ä¸€**: SSoT(Single Source of Truth)ã®ç¢ºç«‹
   - CreatureManager ã‚’å”¯ä¸€ã® source ã«ã™ã‚‹
   - tile_nodes ã¯èª­ã¿å–ã‚Šå°‚ç”¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŒ–

2. **APIå±¤ã®ç°¡æ½”åŒ–**: å§”è­²ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‰Šæ¸›
   ```gdscript
   # ç¾åœ¨ï¼ˆè¤‡é›‘ï¼‰
   board.tile_data_manager.get_tile_info()
   # ç†æƒ³å½¢
   board.get_tile_info()  // internal delegation
   ```

3. **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒ–**: subsystems ã‚’ç‹¬ç«‹ã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«
   - TileGrid: ã‚¿ã‚¤ãƒ«é…ç½®ãƒ»ãƒ‡ãƒ¼ã‚¿ç®¡ç†
   - CreatureLayer: ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ç”Ÿå‘½ç®¡ç†
   - MovementSystem: ç§»å‹•ãƒ»ã‚«ãƒ¡ãƒ©ç®¡ç†

4. **Observer ãƒ‘ã‚¿ãƒ¼ãƒ³**: ã‚¿ã‚¤ãƒ«å¤‰æ›´é€šçŸ¥ã‚’è‡ªå‹•åŒ–

---

### ğŸ”´ SpellPhaseHandlerï¼ˆ1,764è¡Œã€ã‚¹ã‚³ã‚¢: 64ç‚¹ï¼‰

**åŸºæœ¬æƒ…å ±**
- **è¡Œæ•°**: 1,764è¡Œï¼ˆæœ€å¤§ï¼‰
- **ãƒ¡ã‚½ãƒƒãƒ‰æ•°**: 80å€‹
- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ•°**: 25+å€‹
- **è²¬å‹™æ•°**: 11+å€‹
- **è¢«ä¾å­˜**: 60+ç®‡æ‰€
- **ä¾å­˜**: 30+å€‹ã®ã‚·ã‚¹ãƒ†ãƒ 

**ä¸»ãªè²¬å‹™**
1. ã‚¹ãƒšãƒ«ãƒ•ã‚§ãƒ¼ã‚ºçŠ¶æ…‹ç®¡ç†ï¼ˆState enum: 5çŠ¶æ…‹ï¼‰
2. ã‚¹ãƒšãƒ«ã‚«ãƒ¼ãƒ‰é¸æŠå‡¦ç†
3. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠUIåˆ¶å¾¡
4. ã‚¹ãƒšãƒ«åŠ¹æœå®Ÿè¡Œï¼ˆSpellEffectExecutorã«å§”è­²ï¼‰
5. ã‚«ãƒ¼ãƒ‰çŠ ç‰²ã‚·ã‚¹ãƒ†ãƒ ï¼ˆCardSacrificeHelperã«å§”è­²ï¼‰
6. CPU ã‚¹ãƒšãƒ«åˆ¤æ–­ï¼ˆCPUSpellAIã«å§”è­²ï¼‰
7. ã‚¢ãƒ«ã‚«ãƒŠã‚¢ãƒ¼ãƒ„çµ±åˆ
8. å¤–éƒ¨ã‚¹ãƒšãƒ«ãƒ¢ãƒ¼ãƒ‰ï¼ˆé­”æ³•ã‚¿ã‚¤ãƒ«ç­‰ï¼‰
9. ç¢ºèªãƒ•ã‚§ãƒ¼ã‚ºç®¡ç†
10. ãƒ‰ãƒ­ãƒ¼ãƒ»ã‚³ã‚¹ãƒˆè¨ˆç®—ï¼ˆç›´æ¥å‚ç…§ï¼‰
11. ã‚¹ãƒšãƒ«å€Ÿç”¨ã‚·ã‚¹ãƒ†ãƒ ï¼ˆSpellBorrowã«å§”è­²ï¼‰

**ä¾å­˜é–¢ä¿‚ï¼ˆè¤‡é›‘ï¼‰**
```
SpellPhaseHandler â†’ {
  // ç›´æ¥ä¿æŒï¼ˆ30+ propertiesï¼‰
  CardSelectionHandler, SpellEffectExecutor,
  CardSacrificeHelper, SpellMysticArts, SpellBorrow,
  SpellTransform, SpellPurify, SpellSynthesis,

  // ç›´æ¥å‚ç…§ï¼ˆGFMçµŒç”±å»ƒæ­¢ï¼‰
  SpellDraw, SpellCostModifier, BattleStatusOverlay,
  TargetSelectionHelper,

  // CPU AI
  CPUSpellAI, CPUMysticArtsAI, CPUHandUtils,
  CPUMovementEvaluator, CPUSpellPhaseHandler,

  // ã‚²ãƒ¼ãƒ ã‚·ã‚¹ãƒ†ãƒ 
  GameFlowManager, BoardSystem3D, UIManager,
  CardSystem, PlayerSystem, BattleSystem
}
```

**è¢«ä¾å­˜**
- GameFlowManagerï¼ˆæœ€å¤§ã®ä¾å­˜å…ƒï¼‰
- DominioCommandHandlerï¼ˆã‚¹ãƒšãƒ«åŠ¹æœãŒå½±éŸ¿ï¼‰
- BattleSystemï¼ˆã‚¹ãƒšãƒ«åŠ¹æœã«ã‚ˆã‚‹ãƒãƒˆãƒ«å¤‰æ›´ï¼‰

**å•é¡Œç‚¹**
- **ã‚¹ãƒšãƒ«å‡¦ç†ã®ä¸€æ¥µé›†ä¸­**:
  - å…¨ã‚¹ãƒšãƒ«ã‚·ã‚¹ãƒ†ãƒ ãŒã“ã“ã«é›†ç´„
  - ã‚¹ãƒšãƒ«è¿½åŠ  â†’ SpellPhaseHandler ä¿®æ­£ãŒå¿…é ˆ
  - è²¬å‹™ãŒã€Œãƒ•ã‚§ãƒ¼ã‚ºç®¡ç†ã€ã‹ã‚‰ã€Œã‚¹ãƒšãƒ«å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ã€ã«å¤‰è³ª

- **ç›´æ¥å‚ç…§ã®å¢—åŠ **:
  - GFMçµŒç”±ã‚’å»ƒæ­¢ã—ã¦ç›´æ¥å‚ç…§ã«å¤‰æ›´ï¼ˆè¨­è¨ˆæ„å›³ã¯è‰¯ã„ãŒé‡ãŒå¢—åŠ ï¼‰
  - 30å€‹ä»¥ä¸Šã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå­˜åœ¨

- **çŠ¶æ…‹ç®¡ç†ã®è¤‡é›‘æ€§**:
  - State: 5çŠ¶æ…‹
  - ã•ã‚‰ã« is_external_spell_mode, is_magic_tile_mode ãªã©6+ã®ãƒ•ãƒ©ã‚°
  - çŠ¶æ…‹é·ç§»ã®è¤‡é›‘æ€§ãŒé«˜ã„

- **ãƒ†ã‚¹ãƒˆå›°é›£æ€§**:
  - å¤šæ•°ã®ä¾å­˜ãŒå¿…è¦ã§ã€ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè£…ãŒå›°é›£
  - çµ±åˆãƒ†ã‚¹ãƒˆã«é ¼ã‚‰ã–ã‚‹ã‚’å¾—ãªã„

**æ¨å¥¨æ”¹å–„**
1. **ã‚¹ãƒšãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®åˆ†å‰²**: Strategy ãƒ‘ã‚¿ãƒ¼ãƒ³
   ```gdscript
   // ç¾åœ¨
   SpellPhaseHandler.execute_spell(spell_data)

   // ç†æƒ³å½¢
   spell_strategy = SpellStrategyFactory.create(spell_type)
   spell_strategy.execute(context)
   ```

2. **ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠã®å¤–éƒ¨åŒ–**:
   - TargetSelectionHelper ã®ç‹¬ç«‹åŒ–ï¼ˆæ—¢ã«ä¸€éƒ¨å®Ÿè£…ï¼‰
   - UIå‡¦ç†ã‚’ãƒ•ã‚§ãƒ¼ã‚ºãƒãƒ³ãƒ‰ãƒ©ã‹ã‚‰åˆ†é›¢

3. **çŠ¶æ…‹æ©Ÿæ¢°ã®æ˜ç¢ºåŒ–**:
   - State Machine ã‚¯ãƒ©ã‚¹åŒ–ï¼ˆGameFlowManager ã®ä¾‹ã«å¾“ã†ï¼‰
   - çŠ¶æ…‹é·ç§»ã‚’ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆåŒ–

4. **CPU AI ã®åˆ†é›¢**:
   - CPUSpellAI ã‚’ç›´æ¥å®Ÿè£…ã›ãšã€Evaluator ãƒ‘ã‚¿ãƒ¼ãƒ³åŒ–
   - ã‚¹ãƒšãƒ«ãƒãƒ³ãƒ‰ãƒ©ã‹ã‚‰ CPUåˆ¤æ–­ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŠ½å‡º

---

### ğŸŸ¡ DominioCommandHandlerï¼ˆ1,227è¡Œã€ã‚¹ã‚³ã‚¢: 58ç‚¹ï¼‰

**åŸºæœ¬æƒ…å ±**
- **è¡Œæ•°**: 1,227è¡Œ
- **ãƒ¡ã‚½ãƒƒãƒ‰æ•°**: 73å€‹
- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ•°**: 20+å€‹
- **è²¬å‹™æ•°**: 9+å€‹
- **è¢«ä¾å­˜**: 50+ç®‡æ‰€
- **ä¾å­˜**: 20å€‹ä»¥ä¸Šã®ã‚·ã‚¹ãƒ†ãƒ 

**ä¸»ãªè²¬å‹™**
1. ãƒ‰ãƒŸãƒ‹ã‚ªã‚³ãƒãƒ³ãƒ‰ UI åˆ¶å¾¡ï¼ˆçŠ¶æ…‹ç®¡ç†ï¼‰
2. åœŸåœ°é¸æŠå‡¦ç†
3. ã‚¢ã‚¯ã‚·ãƒ§ãƒ³é¸æŠå‡¦ç†ï¼ˆãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ãƒ»ç§»å‹•ãƒ»äº¤æ›ãƒ»åœ°å½¢å¤‰åŒ–ï¼‰
4. ç§»å‹•ãƒãƒˆãƒ«å‡¦ç†ï¼ˆæ•µåœ°ä¾µæ”»æ™‚ã®æˆ¦é—˜ï¼‰
5. åœ°å½¢é¸æŠUI
6. ãƒ¬ãƒ™ãƒ«é¸æŠUI
7. ç§»å‹•å…ˆé¸æŠï¼ˆéš£æ¥ã‚¿ã‚¤ãƒ«æŒ‡å®šï¼‰
8. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒãƒ¼ã‚«ãƒ¼åˆ¶å¾¡
9. äº¤æ›ãƒ¢ãƒ¼ãƒ‰ç®¡ç†

**ä¾å­˜é–¢ä¿‚**
```
DominioCommandHandler â†’ {
  // UIé–¢é€£
  UIManager, DominioOrderUI, land_info_panel,

  // ã‚¹ãƒšãƒ«ã‚·ã‚¹ãƒ†ãƒ ï¼ˆç›´æ¥å‚ç…§ï¼‰
  SpellLand, SpellWorldCurse, SpellCurse,

  // ã‚²ãƒ¼ãƒ ã‚·ã‚¹ãƒ†ãƒ 
  BoardSystem3D, GameFlowManager, PlayerSystem,
  BattleSystem, BattleStatusOverlay,

  // ãƒ˜ãƒ«ãƒ‘ãƒ¼
  TargetSelectionHelper, LandSelectionHelper,

  // é€šçŸ¥
  SpellCastNotificationUI
}
```

**å•é¡Œç‚¹**
- **çŠ¶æ…‹ç®¡ç†ã®è¤‡é›‘æ€§**:
  - 7ã¤ã® State enum ï¼ˆCLOSED, SELECTING_LAND, SELECTING_ACTION ãªã©ï¼‰
  - å„çŠ¶æ…‹ã§10+å€‹ã®å‡¦ç†ãŒç•°ãªã‚‹

- **è¤‡æ•°ã®ãƒ¢ãƒ¼ãƒ‰é‡å±¤**:
  - swap_mode, terrain_change, move_destination ç­‰
  - çŠ¶æ…‹ã¨ãƒ¢ãƒ¼ãƒ‰ã®çµ„ã¿åˆã‚ã›ã§è¤‡é›‘æ€§ãŒå¢—åŠ 

- **UIçµåˆåº¦**:
  - DominioOrderUI ã¨ã®å¼·ã„çµåˆ
  - ç”»é¢æ›´æ–°ã‚’ DominioCommandHandler ãŒç›´æ¥åˆ¶å¾¡

- **ãƒãƒˆãƒ«å‡¦ç†ã¨ã®çµåˆ**:
  - ç§»å‹•ãƒãƒˆãƒ«å‡¦ç†ã‚’å«ã‚€ãŸã‚ BattleSystem, BattleStatusOverlay ã«ä¾å­˜
  - è²¬å‹™ãŒã€Œã‚³ãƒãƒ³ãƒ‰å‡¦ç†ã€ã‹ã‚‰ã€Œãƒãƒˆãƒ«èª¿æ•´ã€ã«æ‹¡å¤§

**æ¨å¥¨æ”¹å–„**
1. **Strategy ãƒ‘ã‚¿ãƒ¼ãƒ³**: ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¨®åˆ¥ã”ã¨ã®ãƒãƒ³ãƒ‰ãƒ©åŒ–
2. **UIåˆ†é›¢**: UIComponentFactory ã§ç”»é¢é·ç§»ã‚’ç®¡ç†
3. **ãƒãƒˆãƒ«å‡¦ç†ã®æŠ½å‡º**: MoveBattleExecutor ã®ç‹¬ç«‹åŒ–

---

### ğŸŸ¡ GameFlowManagerï¼ˆ739è¡Œã€ã‚¹ã‚³ã‚¢: 56ç‚¹ï¼‰

**åŸºæœ¬æƒ…å ±**
- **è¡Œæ•°**: 739è¡Œï¼ˆä¸­ç¨‹åº¦ï¼‰
- **ãƒ¡ã‚½ãƒƒãƒ‰æ•°**: 43å€‹
- **è²¬å‹™æ•°**: 8+å€‹
- **è¢«ä¾å­˜**: 80ç®‡æ‰€ï¼ˆæœ€å¤§ï¼‰
- **ä¾å­˜**: 20+å€‹ã®ã‚·ã‚¹ãƒ†ãƒ 

**ä¸»ãªè²¬å‹™**
1. ã‚²ãƒ¼ãƒ ãƒ•ã‚§ãƒ¼ã‚ºç®¡ç†ï¼ˆSETUP, DICE_ROLL, MOVING, TILE_ACTION, BATTLE, END_TURNï¼‰
2. ã‚¿ãƒ¼ãƒ³é€²è¡Œç®¡ç†
3. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ‡ã‚Šæ›¿ãˆå‡¦ç†
4. ã‚·ã‚¹ãƒ†ãƒ å‚ç…§ã®ä¸€å…ƒç®¡ç†
5. ã‚·ã‚°ãƒŠãƒ«ä¸­æ¢ï¼ˆãƒãƒ–åŒ–ï¼‰
6. ç ´ç”£å‡¦ç†ã®å§”è­²
7. ã‚«ãƒ¡ãƒ©åˆ¶å¾¡ã®å§”è­²
8. ã‚²ãƒ¼ãƒ çµ‚äº†åˆ¤å®š

**è¢«ä¾å­˜ã®é«˜ã•**
- **80ç®‡æ‰€**ã‹ã‚‰ã®å‚ç…§ï¼ˆæœ€å¤šï¼‰
- ç†ç”±: ã‚²ãƒ¼ãƒ é€²è¡Œã®æœ€ä¸Šä½ã«ã‚ã‚‹ãŸã‚

**å•é¡Œç‚¹**
- **å‚ç…§ãƒãƒ–åŒ–**:
  - ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ãŒ GFM ã‚’çµŒç”±ã—ã¦ã‚·ã‚¹ãƒ†ãƒ é–“é€šä¿¡
  - `game_flow_manager.board_system_3d.tile_action_processor` ã®ã‚ˆã†ãªãƒã‚§ãƒ¼ãƒ³ã‚¢ã‚¯ã‚»ã‚¹

- **State Machine ã®å¾Œä»˜ã‘**:
  - ã‚²ãƒ¼ãƒ é–‹å§‹å¾Œã« State Machine ã‚’åˆæœŸåŒ–
  - ãƒ•ã‚§ãƒ¼ã‚ºå¤‰æ›´ã®ãŸã³ã« 2ã¤ã®ç®¡ç†æ©Ÿæ§‹ï¼ˆcurrent_phase ã¨ State Machineï¼‰ã‚’åŒæœŸ

- **ãƒ‡ãƒãƒƒã‚°çŠ¶æ…‹ãƒ•ãƒ©ã‚°ã®å¤šç”¨**:
  - `_is_ending_turn` ãƒ•ãƒ©ã‚°ã§äºŒé‡å®Ÿè¡Œã‚’é˜²æ­¢
  - BUG-000 å¯¾å¿œã®ç—•è·¡ãŒè¤‡æ•°å­˜åœ¨

**æ¨å¥¨æ”¹å–„**
1. **State Machine ã®äº‹å‰åˆæœŸåŒ–**: ã‚¯ãƒ©ã‚¹åˆæœŸåŒ–æ™‚ã«å®Ÿæ–½
2. **å‚ç…§è§£æ”¾**: ä¸è¦ãªä¸­ç¶™å‚ç…§ã‚’å‰Šé™¤

---

## 3. è²¬å‹™åˆ†æãƒãƒˆãƒªã‚¯ã‚¹

### æ©Ÿèƒ½å˜ä½ã§ã®è²¬å‹™ã®åˆ†æ•£

| æ©Ÿèƒ½ | ç¾åœ¨ã®å ´æ‰€ | ç†æƒ³çš„ãªå ´æ‰€ |
|------|-----------|-----------|
| **UIç®¡ç†** | UIManagerï¼ˆé›†ç´„ï¼‰ | UIStateController + å„ãƒ•ã‚§ãƒ¼ã‚ºUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| **ãƒœãƒ¼ãƒ‰ç®¡ç†** | BoardSystem3Dï¼ˆé›†ç´„ï¼‰ | TileGrid + CreatureLayer + MovementSystem |
| **ã‚¹ãƒšãƒ«å‡¦ç†** | SpellPhaseHandlerï¼ˆé›†ç´„ï¼‰ | SpellExecutor + SpellFactory + å„ã‚¹ãƒšãƒ«å®Ÿè£… |
| **ãƒ‰ãƒŸãƒ‹ã‚ªå‡¦ç†** | DominioCommandHandlerï¼ˆé›†ç´„ï¼‰ | ActionStrategy + å„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè£… |
| **ãƒ•ã‚§ãƒ¼ã‚ºç®¡ç†** | GameFlowManagerï¼ˆä¸­åº¦ï¼‰ | GameStateMachineï¼ˆæ—¢ã«å®Ÿè£…ä¸­ï¼‰ |

---

## 4. å„ªå…ˆåº¦åˆ¥æ”¹å–„ãƒ—ãƒ©ãƒ³

### P0 (å³åº§ã«å¯¾å¿œ)

#### P0-1: UIManager ã®è²¬å‹™åˆ†é›¢
**ç¾çŠ¶**: UIå…¨ä½“ã®ä¸­å¤®ç®¡ç†ï¼ˆ1,069è¡Œï¼‰
**æ”¹å–„**: ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥ UIController åˆ†é›¢

**å®Ÿè£…è¨ˆç”»**:
1. `UIStateController` ã‚¯ãƒ©ã‚¹ä½œæˆï¼ˆãƒ•ã‚§ãƒ¼ã‚ºã”ã¨ã®UIçŠ¶æ…‹ç®¡ç†ï¼‰
2. æ—¢å­˜å§”è­²ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é€†å§”è­²ã«å¤‰æ›´
   ```gdscript
   // before: UIManager ãŒå„UIã® init/show/hide ã‚’ç®¡ç†
   // after: UIè‡ªèº«ãŒ initialization ã‚’ã™ã‚‹ã€UIManager ã¯ç™»éŒ²ã®ã¿
   ```
3. æ‰‹æœ­UI, æˆ¦é—˜UI, ãƒ‰ãƒŸãƒ‹ã‚ªUI ã‚’ç‹¬ç«‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒ–
4. UIManager ã‚’ã€ŒUIç™»éŒ²ã‚»ãƒ³ã‚¿ãƒ¼ã€ã«ç¸®å°åŒ–

**è¦‹ç©**: 3-4æ—¥
**åŠ¹æœ**:
- UIManager è¡Œæ•°: 1,069 â†’ 300-400è¡Œï¼ˆ60%å‰Šæ¸›ï¼‰
- UIè¿½åŠ æ™‚ã®å¤‰æ›´ç®‡æ‰€: 3-5 â†’ 1ï¼ˆå¤‰æ›´ç°¡ç´ åŒ–ï¼‰

---

#### P0-2: BoardSystem3D ã® SSoT ç¢ºç«‹
**ç¾çŠ¶**: creature_data ãŒ CreatureManager, BaseTile, TileDataManager ã«3ç®‡æ‰€ã§å­˜åœ¨
**æ”¹å–„**: CreatureManager ã‚’å”¯ä¸€ã® source ã«

**å®Ÿè£…è¨ˆç”»**:
1. `CreatureManager.creatures[tile_index]` ã‚’å”¯ä¸€ã® source
2. `tile_nodes` ã‚’èª­ã¿å–ã‚Šå°‚ç”¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«
3. `TileDataManager` ã¯ `CreatureManager` ã‚’çµŒç”±ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹
4. æ›´æ–°æ™‚ã®ã‚·ã‚°ãƒŠãƒ« ãƒã‚§ãƒ¼ãƒ³ç¢ºç«‹

**è¦‹ç©**: 2-3æ—¥
**åŠ¹æœ**:
- ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§å•é¡Œè§£æ±º
- ãƒ‡ãƒãƒƒã‚°æ™‚é–“çŸ­ç¸®ï¼ˆsource ã‚’1ã¤ã«çµã‚‹ã“ã¨ã§ç‰¹å®šãŒå®¹æ˜“ï¼‰

---

#### P0-3: SpellPhaseHandler ã® State Machine æ˜ç¢ºåŒ–
**ç¾çŠ¶**: State enum ã¨ is_xxx_mode ãƒ•ãƒ©ã‚°ãŒæ··åœ¨
**æ”¹å–„**: çµ±ä¸€ã•ã‚ŒãŸ State Machine å°å…¥

**å®Ÿè£…è¨ˆç”»**:
1. `SpellPhaseStateMachine` ã‚¯ãƒ©ã‚¹ä½œæˆ
2. çŠ¶æ…‹é·ç§»ã‚’æ˜ç¤ºçš„ã«ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆåŒ–
3. 5ã¤ã® State ã‚’æ‹¡å¼µï¼ˆtarget selection ã®è©³ç´°åŒ–ï¼‰
4. ãƒ¢ãƒ¼ãƒ‰ãƒ•ãƒ©ã‚°ã‚’ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ•°ã«ç§»è¡Œ

**è¦‹ç©**: 2æ—¥
**åŠ¹æœ**:
- çŠ¶æ…‹é·ç§»ã®äºˆæ¸¬å¯èƒ½æ€§å‘ä¸Š
- ãƒã‚°ï¼ˆä¸æ­£ãªçŠ¶æ…‹é·ç§»ï¼‰ã®æ—©æœŸæ¤œå‡º

---

### P1 (çŸ­æœŸå¯¾å¿œ: 1-2é€±é–“)

#### P1-1: SpellPhaseHandler ã‚’ã‚¹ãƒšãƒ«æˆ¦ç•¥ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åˆ†å‰²
**ç¾çŠ¶**: å…¨ã‚¹ãƒšãƒ«å‡¦ç†ã‚’1ãƒ•ã‚¡ã‚¤ãƒ«ã§ç®¡ç†
**æ”¹å–„**: SpellStrategy ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å„ã‚¹ãƒšãƒ«ç‹¬ç«‹åŒ–

**å®Ÿè£…è¨ˆç”»**:
1. `SpellStrategy` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
2. `fire_spell_strategy.gd`, `water_spell_strategy.gd` ç­‰ã‚’ä½œæˆ
3. `SpellPhaseHandler` ã‹ã‚‰å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ã ã‘ã‚’æ®‹ã™
4. CPU ã‚¹ãƒšãƒ«åˆ¤æ–­ã‚’ SpellEvaluator ã«å¤–éƒ¨åŒ–

**è¦‹ç©**: 4-5æ—¥
**åŠ¹æœ**:
- SpellPhaseHandler: 1,764 â†’ 500è¡Œï¼ˆ70%å‰Šæ¸›ï¼‰
- ã‚¹ãƒšãƒ«è¿½åŠ æ™‚ã®å¤‰æ›´: SpellPhaseHandler ä¸è¦ï¼ˆæ–°Strategyè¿½åŠ ã®ã¿ï¼‰
- ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£: å„ã‚¹ãƒšãƒ«ã‚’ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå¯èƒ½ã«

---

#### P1-2: DominioCommandHandler ã‚’ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åˆ†å‰²
**ç¾çŠ¶**: å…¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’1ãƒ•ã‚¡ã‚¤ãƒ«ã§ç®¡ç†
**æ”¹å–„**: Command/Strategy ãƒ‘ã‚¿ãƒ¼ãƒ³åŒ–

**å®Ÿè£…è¨ˆç”»**:
1. `ActionStrategy` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
2. `LevelUpAction`, `MoveAction`, `SwapAction`, `TerrainAction` å®Ÿè£…
3. `DominioCommandHandler` ã‚’ UIåˆ¶å¾¡ã«ç‰¹åŒ–
4. ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œã‚’ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³åŒ–

**è¦‹ç©**: 3-4æ—¥
**åŠ¹æœ**:
- DominioCommandHandler: 1,227 â†’ 400-500è¡Œ
- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ æ™‚: æ–° Strategy è¿½åŠ ã®ã¿

---

### P2 (ä¸­é•·æœŸå¯¾å¿œ: 2-4é€±é–“)

#### P2-1: BoardSystem3D ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒ–
**æ”¹å–„æ¡ˆ**:
```gdscript
class_name GameBoard extends Node3D

# ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒ–
@export var tile_grid: TileGrid  # ã‚¿ã‚¤ãƒ«é…ç½®ãƒ»ãƒ‡ãƒ¼ã‚¿
@export var creature_system: CreatureLayer  # ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ç®¡ç†
@export var movement_system: MovementSystem  # ç§»å‹•ãƒ»ã‚«ãƒ¡ãƒ©
@export var interaction_system: InteractionSystem  # ã‚¿ãƒƒãƒ—ãƒ»é¸æŠ
```

**è¦‹ç©**: 1é€±é–“
**åŠ¹æœ**:
- BoardSystem3D: 1,031 â†’ 200-300è¡Œï¼ˆå¤–éƒ¨å§”è­²åŒ–ï¼‰
- ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£: å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç‹¬ç«‹ãƒ†ã‚¹ãƒˆå¯èƒ½

---

#### P2-2: GameFlowManager ã®å‚ç…§æ§‹é€ ç°¡æ½”åŒ–
**æ”¹å–„æ¡ˆ**:
```gdscript
# ç¾åœ¨
game_flow_manager.board_system_3d.tile_action_processor.on_level_up()

# ç†æƒ³å½¢ï¼ˆGameFlowManager.set_*ã§ç›´æ¥å‚ç…§åŒ–ï¼‰
game_flow_manager.on_level_up_selected(target_level, cost)
# â†’ board_system_3d.tile_action_processor ã¸ç›´æ¥å§”è­²
```

**è¦‹ç©**: 2æ—¥
**åŠ¹æœ**:
- GFM ã®å‚ç…§ãƒãƒ–åŒ–ã‚’è»½æ¸›
- å‘¼ã³å‡ºã—å´ã®ã‚³ãƒ¼ãƒ‰ç°¡æ½”åŒ–

---

## 5. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³é©ç”¨ã‚¬ã‚¤ãƒ‰

### æ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³

#### 1. **Strategy ãƒ‘ã‚¿ãƒ¼ãƒ³** (SpellPhaseHandler, DominioCommandHandler ã«é©ç”¨)
```gdscript
# Current: å…¨logic in handler
# Pattern:
interface SpellStrategy:
  func execute(context: SpellContext) -> bool

class FireballStrategy implements SpellStrategy:
  func execute(context):
    # Fire spell logic
    return true

# Handler: strategy dispatcher
var strategies = {
  "fireball": FireballStrategy.new(),
  "ice": IceStrategy.new()
}
func execute_spell(spell_data):
  var strategy = strategies[spell_data.type]
  return strategy.execute(spell_context)
```

#### 2. **Facade ãƒ‘ã‚¿ãƒ¼ãƒ³æ”¹å–„** (UIManager ã«é©ç”¨)
```gdscript
# Current: UIManager.card_selection_ui.show_selection()
# Pattern: Simplified facade with internal delegation
func show_card_selection(player):
  _card_selection_controller.show_selection(player)

# Internal implementation hidden
var _card_selection_controller: CardSelectionController
```

#### 3. **Observer ãƒ‘ã‚¿ãƒ¼ãƒ³** (BoardSystem3D ã«é©ç”¨)
```gdscript
# Creature changes automatically notify dependent systems
creature_data.changed.connect(_on_creature_changed)
# vs current: manual synchronization in multiple places
```

#### 4. **Command ãƒ‘ã‚¿ãƒ¼ãƒ³** (DominioCommandHandler ã«é©ç”¨)
```gdscript
var commands = {
  "level_up": LevelUpCommand.new(),
  "move": MoveCommand.new(),
  "swap": SwapCommand.new()
}
func execute_action(action_type: String):
  var cmd = commands[action_type]
  cmd.execute(board_state)
```

---

## 6. æ”¹å–„ã«ã‚ˆã‚‹æœŸå¾…åŠ¹æœ

### ã‚³ãƒ¼ãƒ‰å“è³ªå‘ä¸Š

| æŒ‡æ¨™ | ç¾åœ¨ | æ”¹å–„å¾Œ | å‰Šæ¸›ç‡ |
|------|------|--------|--------|
| **ç¥ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ•°** | 3å€‹ï¼ˆğŸ”´ï¼‰ | 0å€‹ | 100% |
| **1000è¡Œè¶…ã®ãƒ•ã‚¡ã‚¤ãƒ«** | 7å€‹ | 0å€‹ | 100% |
| **500è¡Œè¶…ã®ãƒ•ã‚¡ã‚¤ãƒ«** | 15å€‹ | 5-6å€‹ | 60% |
| **å¹³å‡ãƒ•ã‚¡ã‚¤ãƒ«è¡Œæ•°** | 300è¡Œ | 250è¡Œ | 17% |

### ä¿å®ˆæ€§å‘ä¸Š

| é …ç›® | åŠ¹æœ |
|------|------|
| **ã‚¹ãƒšãƒ«è¿½åŠ æ™‚ã®å¤‰æ›´** | UIManager, SpellPhaseHandler â†’ æ–° Strategy ã®ã¿ |
| **ãƒ‰ãƒŸãƒ‹ã‚ªã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ ** | DominioCommandHandler â†’ æ–° Action ã®ã¿ |
| **UIè¿½åŠ ** | UIManager, è¤‡æ•°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ â†’ UIStateController + æ–°Component |
| **ãƒ†ã‚¹ãƒˆå®Ÿè£…** | å›°é›£ï¼ˆå¤šæ•°ä¾å­˜ï¼‰ â†’ å®¹æ˜“ï¼ˆå˜ä¸€è²¬å‹™ï¼‰ |

### é–‹ç™ºé€Ÿåº¦å‘ä¸Š

- **æ©Ÿèƒ½è¿½åŠ **: ç¾åœ¨ 3-5æ—¥ï¼ˆæ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä¿®æ­£å¿…é ˆï¼‰â†’ 1-2æ—¥ï¼ˆæ–°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¿½åŠ ï¼‰
- **ãƒã‚°ä¿®æ­£**: ç¾åœ¨ å½±éŸ¿ç¯„å›²ãŒåºƒã„ â†’ ç‰¹å®šè²¬å‹™ã«é™å®š
- **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**: å®¹æ˜“åŒ–ï¼ˆå°è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£ï¼‰

---

## 7. å®Ÿè£…ä¸Šã®æ³¨æ„ç‚¹

### ç§»è¡Œæˆ¦ç•¥

#### Phase 1: æº–å‚™ï¼ˆ1é€±é–“ï¼‰
1. State Machine ã‚¯ãƒ©ã‚¹åŒ–ï¼ˆæ—¢ã«å®Ÿè£…ä¸­ï¼‰
2. ç›´æ¥å‚ç…§ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¨™æº–åŒ–
3. ãƒ†ã‚¹ãƒˆåŸºç›¤æ•´å‚™

#### Phase 2: SpellPhaseHandler åˆ†å‰²ï¼ˆ2é€±é–“ï¼‰
1. `SpellStrategy` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
2. æ—¢å­˜ã‚¹ãƒšãƒ«ã‚’æˆ¦ç•¥ã«ç§»è¡Œï¼ˆæ®µéšçš„ï¼‰
3. ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚°

#### Phase 3: UIManager, BoardSystem3D åˆ†å‰²ï¼ˆ3é€±é–“ï¼‰
1. å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
2. æ—¢å­˜å‚ç…§ã®ç½®ãæ›ãˆ
3. çµ±åˆãƒ†ã‚¹ãƒˆ

#### Phase 4: DominioCommandHandler åˆ†å‰²ï¼ˆ1é€±é–“ï¼‰
1. Action ãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…
2. UI å†æ§‹ç¯‰
3. ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚°

**ç·å·¥æœŸ**: 6-7é€±é–“

### ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨ˆç”»

å„ãƒ•ã‚§ãƒ¼ã‚ºã§ä»¥ä¸‹ã®ä»•çµ„ã¿ã‚’ç”¨æ„:
- æ—¢å­˜ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã¨ã®å…±å­˜æœŸé–“ï¼ˆãƒ‡ãƒ¥ã‚¢ãƒ«ãƒ¢ãƒ¼ãƒ‰ï¼‰
- æ®µéšçš„ãªå‚ç…§ç½®ãæ›ãˆ
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ç¶™ç¶š

---

## 8. ã¾ã¨ã‚

### è¨ºæ–­çµæœ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ **3ã¤ã®é‡åº¦ãªç¥ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ** ã¨ **2ã¤ã®ä¸­åº¦ãªç¥ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ** ãŒå­˜åœ¨ã—ã¾ã™ã€‚

**æ ¹æœ¬åŸå› **:
1. **ã‚²ãƒ¼ãƒ è¤‡é›‘æ€§ã®å¢—åŠ **: ã‚¹ãƒšãƒ«ã€ãƒ‰ãƒŸãƒ‹ã‚ªã€UI ãŒæ‹¡å¼µã™ã‚‹ã«ã¤ã‚Œæ—¢å­˜ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã«æ©Ÿèƒ½è¿½åŠ 
2. **ãƒ•ã‚¡ã‚µãƒ¼ãƒ‰åŒ–**: å¤§è¦æ¨¡ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒã‚¤ãƒ³ãƒˆãŒé›†ç´„
3. **è²¬å‹™ã®æ›–æ˜§æ€§**: ã€Œç®¡ç†è€…ã€ã¨ã€Œå®Ÿè¡Œè€…ã€ã®åŒºåˆ¥ãŒä¸æ˜ç¢º

### è§£æ±ºæ–¹å‘

**æ®µéšçš„ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒ–** ã‚’æ¨å¥¨:
- **çŸ­æœŸï¼ˆP0-P1ï¼‰**: è²¬å‹™åˆ†é›¢ã‚’æœ€å„ªå…ˆï¼ˆStrategy/Command ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
- **ä¸­æœŸï¼ˆP2ï¼‰**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒ–ï¼ˆFacade ã®ç°¡æ½”åŒ–ï¼‰
- **é•·æœŸ**: ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹çš„ãªç‹¬ç«‹ã—ãŸæ©Ÿèƒ½ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–

### åŠ¹æœ

- **ä¿å®ˆæ€§**: å„è²¬å‹™ã‚’300è¡Œä»¥ä¸‹ã«é™å®š â†’ ç†è§£ãƒ»å¤‰æ›´ãŒå®¹æ˜“
- **æ‹¡å¼µæ€§**: æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã®å½±éŸ¿ç¯„å›²ã‚’æœ€å°åŒ–
- **ãƒ†ã‚¹ãƒˆæ€§**: ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè£…ã‚’å¯èƒ½ã«

---

## ä»˜éŒ²: ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ï¼ˆè¡Œæ•°é †ï¼‰

```
1764 spell_phase_handler.gd (ğŸ”´é‡åº¦)
1227 dominio_command_handler.gd (ğŸŸ¡ä¸­åº¦)
1314 card_selection_ui.gd (UI component)
1245 cpu_movement_evaluator.gd (AI component)
1156 spell_mystic_arts.gd (spell system)
1114 cpu_spell_target_selector.gd (AI component)
1108 battle_special_effects.gd (battle system)
1107 battle_skill_processor.gd (battle system)
1070 card_selection_handler.gd (spell helper)
1069 ui_manager.gd (ğŸ”´é‡åº¦)
1058 tutorial_manager.gd (tutorial system)
1053 cpu_target_resolver.gd (AI component)
1031 board_system_3d.gd (ğŸ”´é‡åº¦)
1006 battle_execution.gd (battle system)
 973 cpu_territory_ai.gd (AI component)
 957 cpu_spell_ai.gd (AI component)
 945 cpu_battle_ai.gd (AI component)
 890 spell_magic.gd (spell system)
 884 land_action_helper.gd (helper)
 832 item_phase_handler.gd (phase handler)
```

**åˆè¨ˆ**: 87,631è¡Œä¸­ 20,569è¡Œï¼ˆ23%ï¼‰ãŒ500è¡Œä»¥ä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«

