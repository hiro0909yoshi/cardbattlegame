# ç„¡åŠ¹åŒ–ã‚¹ã‚­ãƒ«è¨­è¨ˆæ›¸

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: ã‚«ãƒ«ãƒ‰ã‚»ãƒ—ãƒˆé¢¨ã‚«ãƒ¼ãƒ‰ãƒãƒˆãƒ«ã‚²ãƒ¼ãƒ   
**ä½œæˆæ—¥**: 2025å¹´10æœˆ20æ—¥  
**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ20æ—¥

---

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ç„¡åŠ¹åŒ–ã®åŸºæœ¬ä»•æ§˜](#ç„¡åŠ¹åŒ–ã®åŸºæœ¬ä»•æ§˜)
3. [ç„¡åŠ¹åŒ–ã‚¿ã‚¤ãƒ—ä¸€è¦§](#ç„¡åŠ¹åŒ–ã‚¿ã‚¤ãƒ—ä¸€è¦§)
4. [å®Ÿè£…ã™ã‚‹ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ä¸€è¦§](#å®Ÿè£…ã™ã‚‹ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ä¸€è¦§)
5. [ãƒ‡ãƒ¼ã‚¿æ§‹é€ ](#ãƒ‡ãƒ¼ã‚¿æ§‹é€ )
6. [å®Ÿè£…ãƒ•ãƒ­ãƒ¼](#å®Ÿè£…ãƒ•ãƒ­ãƒ¼)
7. [ä»–ã‚¹ã‚­ãƒ«ã¨ã®ç›¸äº’ä½œç”¨](#ä»–ã‚¹ã‚­ãƒ«ã¨ã®ç›¸äº’ä½œç”¨)
8. [å®Ÿè£…ã®å„ªå…ˆé †ä½](#å®Ÿè£…ã®å„ªå…ˆé †ä½)

---

## æ¦‚è¦

### ç„¡åŠ¹åŒ–ã‚¹ã‚­ãƒ«ã¨ã¯

æ•µã‹ã‚‰ã®æ”»æ’ƒã‚’æ¡ä»¶ã«å¿œã˜ã¦**å®Œå…¨ç„¡åŠ¹åŒ–**ã¾ãŸã¯**è»½æ¸›**ã™ã‚‹ãƒ‘ãƒƒã‚·ãƒ–ã‚¹ã‚­ãƒ«ã€‚

### ä¸»ãªç‰¹å¾´

- âœ… æ¡ä»¶ã‚’æº€ãŸã™æ”»æ’ƒã‚’ç„¡åŠ¹åŒ–ã¾ãŸã¯è»½æ¸›
- âœ… å®Œå…¨ç„¡åŠ¹åŒ–ï¼ˆ0ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼‰ã¾ãŸã¯è»½æ¸›ï¼ˆ50%ãªã©ï¼‰
- âœ… ç„¡åŠ¹åŒ–ã—ã¦ã‚‚åæ’ƒã¯é€šå¸¸é€šã‚Šç™ºç”Ÿ
- âœ… ã‚¹ãƒšãƒ«ã‚„ã‚¢ã‚¤ãƒ†ãƒ ã‹ã‚‰ã‚‚ä»˜ä¸å¯èƒ½
- âœ… å·»ç‰©æ”»æ’ƒã¨è²«é€šæ”»æ’ƒã¯**åˆ¥ã€…ã«åˆ¤å®š**

---

## ç„¡åŠ¹åŒ–ã®åŸºæœ¬ä»•æ§˜

### åŠ¹æœ

ç„¡åŠ¹åŒ–ãŒæˆåŠŸã—ãŸå ´åˆï¼š

| é …ç›® | åŠ¹æœ |
|------|------|
| ãƒ€ãƒ¡ãƒ¼ã‚¸ | **0ãƒ€ãƒ¡ãƒ¼ã‚¸**ã¾ãŸã¯**è»½æ¸›ç‡é©ç”¨** |
| å³æ­»åˆ¤å®š | **ã‚¹ã‚­ãƒƒãƒ—**ã•ã‚Œã‚‹ |
| åæ’ƒ | **é€šå¸¸é€šã‚Šç™ºç”Ÿ** |
| ãƒ­ã‚°è¡¨ç¤º | ã€Œã€ç„¡åŠ¹åŒ–ã€‘ã€ã¾ãŸã¯ã€Œã€è»½æ¸›ã€‘ã€è¡¨ç¤º |

### è»½æ¸›ç‡ã®æ‰±ã„

```gdscript
# å®Œå…¨ç„¡åŠ¹åŒ–
reduction_rate = 0.0  # ãƒ€ãƒ¡ãƒ¼ã‚¸ = 0

# 50%è»½æ¸›ï¼ˆID:6 ã‚¬ã‚¹ã‚¯ãƒ©ã‚¦ãƒ‰ï¼‰
reduction_rate = 0.5  # ãƒ€ãƒ¡ãƒ¼ã‚¸ = å…ƒã®ãƒ€ãƒ¡ãƒ¼ã‚¸ Ã— 0.5

# ç„¡åŠ¹åŒ–ãªã—ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
reduction_rate = æŒ‡å®šãªã—  # ãƒ€ãƒ¡ãƒ¼ã‚¸ = å…ƒã®ãƒ€ãƒ¡ãƒ¼ã‚¸ Ã— 0.0ï¼ˆå®Œå…¨ç„¡åŠ¹åŒ–ï¼‰
```

**é‡è¦**: `reduction_rate`ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§**å®Œå…¨ç„¡åŠ¹åŒ–ï¼ˆ0.0ï¼‰**ã¨ã™ã‚‹ã€‚

### åˆ¤å®šã‚¿ã‚¤ãƒŸãƒ³ã‚°

```
ãƒãƒˆãƒ«é–‹å§‹
  â†“
æ”»æ’ƒåŠ›è¨ˆç®—ï¼ˆæ„Ÿå¿œãƒ»å¼·æ‰“ãƒ»ã‚¢ã‚¤ãƒ†ãƒ ãƒ»ã‚¹ãƒšãƒ«é©ç”¨ï¼‰
  â†“
ã€ç„¡åŠ¹åŒ–åˆ¤å®šã€‘â† ã“ã“ã§åˆ¤å®š
  â”œâ”€ ç„¡åŠ¹åŒ–æˆåŠŸ â†’ ãƒ€ãƒ¡ãƒ¼ã‚¸ = 0 ã¾ãŸã¯ è»½æ¸›
  â””â”€ ç„¡åŠ¹åŒ–å¤±æ•— â†’ é€šå¸¸ãƒ€ãƒ¡ãƒ¼ã‚¸å‡¦ç†
  â†“
ãƒ€ãƒ¡ãƒ¼ã‚¸é©ç”¨
  â†“
å³æ­»åˆ¤å®šï¼ˆç„¡åŠ¹åŒ–æˆåŠŸæ™‚ã¯ã‚¹ã‚­ãƒƒãƒ—ï¼‰
  â†“
åæ’ƒå‡¦ç†
```

---

## ç„¡åŠ¹åŒ–ã‚¿ã‚¤ãƒ—ä¸€è¦§

### 1. å±æ€§ç„¡åŠ¹åŒ–ï¼ˆelementï¼‰

**èª¬æ˜**: ç‰¹å®šã®å±æ€§ã‹ã‚‰ã®æ”»æ’ƒã‚’å®Œå…¨ç„¡åŠ¹åŒ–

**åˆ¤å®šåŸºæº–**: æ”»æ’ƒå´ã®**åŸºç¤å±æ€§**ï¼ˆ`creature_data.element`ï¼‰

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
  "nullify_type": "element",
  "element": "fire"  // å˜ä¸€å±æ€§
}
```

ã¾ãŸã¯

```json
{
  "nullify_type": "element",
  "elements": ["wind", "earth"]  // è¤‡æ•°å±æ€§
}
```

**å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼**:
- ID:111 ã‚¤ã‚¨ãƒ†ã‚£ - ç„¡åŠ¹åŒ–[ç«]
- ID:325 ãƒ€ãƒ³ãƒ”ãƒ¼ãƒ« - ç„¡åŠ¹åŒ–[åœ°]
- ID:424 ã‚»ã‚¤ãƒ³ãƒˆ - ç„¡åŠ¹åŒ–[ç„¡]
- ID:100 ã‚¢ãƒ¼ãƒãƒ¼ãƒŠã‚¤ãƒˆ - ç„¡åŠ¹åŒ–[åœ°é¢¨]
- ID:104 ã‚¢ã‚¯ã‚¢ãƒ‰ãƒ©ã‚´ãƒ³ - ç„¡åŠ¹åŒ–[æ°´åœ°]

---

### 2. æœ€å¤§HPæ¡ä»¶ï¼ˆmhp_above / mhp_belowï¼‰

**èª¬æ˜**: æ”»æ’ƒå´ã®æœ€å¤§HPã‚’æ¡ä»¶ã«ç„¡åŠ¹åŒ–

**åˆ¤å®šåŸºæº–**: æ”»æ’ƒå´ã®**åŸºç¤HP**ï¼ˆ`creature_data.hp`ï¼‰
- ã‚¢ã‚¤ãƒ†ãƒ ãƒ»ã‚¹ãƒšãƒ«ã®ãƒãƒ•ã¯**ç„¡è¦–**
- æ„Ÿå¿œãƒœãƒ¼ãƒŠã‚¹ã‚‚**ç„¡è¦–**

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
  "nullify_type": "mhp_above",
  "value": 50  // MHP50ä»¥ä¸Šã‚’ç„¡åŠ¹åŒ–
}
```

```json
{
  "nullify_type": "mhp_below",
  "value": 30  // MHP30ä»¥ä¸‹ã‚’ç„¡åŠ¹åŒ–
}
```

**å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼**:
- ID:16 ã‚·ã‚°ãƒ«ãƒ‰ - ç„¡åŠ¹åŒ–[MHP50ä»¥ä¸Š]
- ID:105 ã‚¢ã‚¯ã‚¢ãƒªãƒ³ã‚° - ç„¡åŠ¹åŒ–[MHP30ä»¥ä¸‹]

---

### 3. STæ¡ä»¶ï¼ˆst_belowï¼‰

**èª¬æ˜**: æ”»æ’ƒå´ã®åŸºæœ¬STã‚’æ¡ä»¶ã«ç„¡åŠ¹åŒ–

**åˆ¤å®šåŸºæº–**: æ”»æ’ƒå´ã®**åŸºç¤AP**ï¼ˆ`creature_data.ap`ï¼‰
- ã‚¢ã‚¤ãƒ†ãƒ ãƒ»ã‚¹ãƒšãƒ«ã®ãƒãƒ•ã¯**ç„¡è¦–**
- æ„Ÿå¿œãƒ»å¼·æ‰“ã‚‚**ç„¡è¦–**

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
  "nullify_type": "st_below",
  "value": 40  // ST40ä»¥ä¸‹ã‚’ç„¡åŠ¹åŒ–
}
```

**å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼**:
- ID:122 ã‚·ãƒ¼ãƒ›ãƒ¼ã‚¹ - ç„¡åŠ¹åŒ–[ST40ä»¥ä¸‹]

---

### 4. å…¨æ”»æ’ƒè»½æ¸›ï¼ˆall_attacksï¼‰

**èª¬æ˜**: å…¨ã¦ã®æ”»æ’ƒã‚’ä¸€å®šå‰²åˆã§è»½æ¸›

**åˆ¤å®šåŸºæº–**: ç„¡æ¡ä»¶ï¼ˆå…¨ã¦ã®æ”»æ’ƒãŒå¯¾è±¡ï¼‰

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
  "nullify_type": "all_attacks",
  "reduction_rate": 0.5  // 50%è»½æ¸›
}
```

**é‡è¦**: ã“ã‚Œã¯å®Œå…¨ç„¡åŠ¹åŒ–ã§ã¯ãªãã€**ãƒ€ãƒ¡ãƒ¼ã‚¸è»½æ¸›**

**å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼**:
- ID:6 ã‚¬ã‚¹ã‚¯ãƒ©ã‚¦ãƒ‰ - ç„¡åŠ¹åŒ–[1/2]ï¼ˆå…¨æ”»æ’ƒã‚’50%ã«è»½æ¸›ï¼‰

---

### 5. èƒ½åŠ›æŒã¡ç„¡åŠ¹åŒ–ï¼ˆhas_abilityï¼‰

**èª¬æ˜**: ç‰¹å®šã®ã‚¹ã‚­ãƒ«ã‚’æŒã¤ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ã‹ã‚‰ã®æ”»æ’ƒã‚’ç„¡åŠ¹åŒ–

**åˆ¤å®šåŸºæº–**: æ”»æ’ƒå´ã®`keywords`é…åˆ—ã«ç‰¹å®šã®èƒ½åŠ›ãŒå«ã¾ã‚Œã‚‹ã‹

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
  "nullify_type": "has_ability",
  "ability": "å…ˆåˆ¶"  // å…ˆåˆ¶æŒã¡ã‚’ç„¡åŠ¹åŒ–
}
```

**å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼**:
- ID:213 ã‚°ãƒ¬ãƒ¼ãƒˆã‚¿ã‚¹ã‚«ãƒ¼ - ç„¡åŠ¹åŒ–[å…ˆåˆ¶æŒã¡]

---

### 6. å·»ç‰©æ”»æ’ƒç„¡åŠ¹åŒ–ï¼ˆscroll_attackï¼‰

**èª¬æ˜**: å·»ç‰©æ”»æ’ƒã‚’ç„¡åŠ¹åŒ–

**åˆ¤å®šåŸºæº–**: `is_using_scroll`ãƒ•ãƒ©ã‚°

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
  "nullify_type": "scroll_attack"
}
```

**å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼**:
- ID:1 ã‚¢ãƒ¼ãƒ ãƒ‰ãƒ‘ãƒ©ãƒ‡ã‚£ãƒ³ - ç„¡åŠ¹åŒ–[å·»ç‰©]
- ID:112 ã‚¤ãƒ‰ - ç„¡åŠ¹åŒ–[å·»ç‰©]

**æ³¨æ„**: å·»ç‰©æ”»æ’ƒã‚¹ã‚­ãƒ«ã®å®Ÿè£…ãŒå‰æ

---

### 7. é€šå¸¸æ”»æ’ƒç„¡åŠ¹åŒ–ï¼ˆnormal_attackï¼‰

**èª¬æ˜**: é€šå¸¸æ”»æ’ƒï¼ˆå·»ç‰©æ”»æ’ƒä»¥å¤–ï¼‰ã‚’ç„¡åŠ¹åŒ–

**åˆ¤å®šåŸºæº–**: `is_using_scroll == false`

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
  "nullify_type": "normal_attack"
}
```

**å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼**:
- ID:106 ã‚¢ãƒ–ã‚µã‚¹ - ç„¡åŠ¹åŒ–[é€šå¸¸æ”»æ’ƒ]ï¼ˆæ¡ä»¶ä»˜ãï¼‰

---

### 8. æ¡ä»¶ä»˜ãç„¡åŠ¹åŒ–ï¼ˆæ¡ä»¶ã¨ã®çµ„ã¿åˆã‚ã›ï¼‰

**èª¬æ˜**: ç‰¹å®šã®æ¡ä»¶ä¸‹ã§ã®ã¿ç„¡åŠ¹åŒ–ãŒç™ºå‹•

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ **:
```json
{
  "nullify_type": "normal_attack",
  "conditions": [
    {
      "condition_type": "land_level_check",
      "operator": ">=",
      "value": 3
    }
  ]
}
```

**å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼**:
- ID:106 ã‚¢ãƒ–ã‚µã‚¹ - æˆ¦é—˜åœ°ãŒãƒ¬ãƒ™ãƒ«3ä»¥ä¸Šã®å ´åˆã€ç„¡åŠ¹åŒ–[é€šå¸¸æ”»æ’ƒ]

**å®Ÿè£…æ–¹é‡**: æ—¢å­˜ã®`ConditionChecker`ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨

---

## å®Ÿè£…ã™ã‚‹ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ä¸€è¦§

### Phase 1: åŸºæœ¬å®Ÿè£…ï¼ˆability_parsedæ—¢å­˜ï¼‰

| ID | åå‰ | å±æ€§ | ç„¡åŠ¹åŒ–æ¡ä»¶ | ãƒ‡ãƒ¼ã‚¿çŠ¶æ³ |
|----|------|------|----------|----------|
| **16** | ã‚·ã‚°ãƒ«ãƒ‰ | ç« | ç„¡åŠ¹åŒ–[MHP50ä»¥ä¸Š] | âœ… å®Ÿè£…æ¸ˆã¿ |
| **111** | ã‚¤ã‚¨ãƒ†ã‚£ | æ°´ | ç„¡åŠ¹åŒ–[ç«] | âœ… å®Ÿè£…æ¸ˆã¿ |
| **325** | ãƒ€ãƒ³ãƒ”ãƒ¼ãƒ« | é¢¨ | ç„¡åŠ¹åŒ–[åœ°] | âœ… å®Ÿè£…æ¸ˆã¿ |
| **424** | ã‚»ã‚¤ãƒ³ãƒˆ | ç„¡ | ç„¡åŠ¹åŒ–[ç„¡] | âœ… å®Ÿè£…æ¸ˆã¿ |

### Phase 2: ãƒ‡ãƒ¼ã‚¿è¿½åŠ ãŒå¿…è¦

| ID | åå‰ | å±æ€§ | ç„¡åŠ¹åŒ–æ¡ä»¶ | ãƒ‡ãƒ¼ã‚¿è¿½åŠ  |
|----|------|------|----------|----------|
| **6** | ã‚¬ã‚¹ã‚¯ãƒ©ã‚¦ãƒ‰ | ç« | å…¨æ”»æ’ƒ50%è»½æ¸› | ğŸ”¶ å¿…è¦ |
| **100** | ã‚¢ãƒ¼ãƒãƒ¼ãƒŠã‚¤ãƒˆ | æ°´ | ç„¡åŠ¹åŒ–[åœ°é¢¨] | ğŸ”¶ å¿…è¦ |
| **104** | ã‚¢ã‚¯ã‚¢ãƒ‰ãƒ©ã‚´ãƒ³ | æ°´ | ç„¡åŠ¹åŒ–[æ°´åœ°] | ğŸ”¶ å¿…è¦ |
| **105** | ã‚¢ã‚¯ã‚¢ãƒªãƒ³ã‚° | æ°´ | ç„¡åŠ¹åŒ–[MHP30ä»¥ä¸‹] | ğŸ”¶ å¿…è¦ |
| **122** | ã‚·ãƒ¼ãƒ›ãƒ¼ã‚¹ | æ°´ | ç„¡åŠ¹åŒ–[ST40ä»¥ä¸‹] | ğŸ”¶ å¿…è¦ |
| **213** | ã‚°ãƒ¬ãƒ¼ãƒˆã‚¿ã‚¹ã‚«ãƒ¼ | åœ° | ç„¡åŠ¹åŒ–[å…ˆåˆ¶æŒã¡] | ğŸ”¶ å¿…è¦ |

### Phase 3: å·»ç‰©å®Ÿè£…å¾Œ

| ID | åå‰ | å±æ€§ | ç„¡åŠ¹åŒ–æ¡ä»¶ | å‰æ |
|----|------|------|----------|------|
| **1** | ã‚¢ãƒ¼ãƒ ãƒ‰ãƒ‘ãƒ©ãƒ‡ã‚£ãƒ³ | ç« | ç„¡åŠ¹åŒ–[å·»ç‰©] | å·»ç‰©å®Ÿè£…å¾Œ |
| **112** | ã‚¤ãƒ‰ | æ°´ | ç„¡åŠ¹åŒ–[å·»ç‰©] | å·»ç‰©å®Ÿè£…å¾Œ |
| **106** | ã‚¢ãƒ–ã‚µã‚¹ | æ°´ | ç„¡åŠ¹åŒ–[é€šå¸¸æ”»æ’ƒ]ï¼ˆæ¡ä»¶ä»˜ãï¼‰ | å·»ç‰©å®Ÿè£…å¾Œ |

---

## ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### ability_parsedæ§‹é€ 

```json
{
  "keywords": ["ç„¡åŠ¹åŒ–"],
  "keyword_conditions": {
    "ç„¡åŠ¹åŒ–": {
      "nullify_type": "element|mhp_above|mhp_below|st_below|all_attacks|has_ability|scroll_attack|normal_attack",
      
      // å±æ€§ç„¡åŠ¹åŒ–ã®å ´åˆ
      "element": "fire",  // å˜ä¸€å±æ€§
      "elements": ["wind", "earth"],  // è¤‡æ•°å±æ€§ï¼ˆelementãŒãªã„å ´åˆï¼‰
      
      // MHP/STæ¡ä»¶ã®å ´åˆ
      "value": 50,
      
      // èƒ½åŠ›æŒã¡ç„¡åŠ¹åŒ–ã®å ´åˆ
      "ability": "å…ˆåˆ¶",
      
      // è»½æ¸›ç‡ï¼ˆæŒ‡å®šãªã— = 0.0 = å®Œå…¨ç„¡åŠ¹åŒ–ï¼‰
      "reduction_rate": 0.5,
      
      // æ¡ä»¶ä»˜ãç„¡åŠ¹åŒ–ã®å ´åˆ
      "conditions": [
        {
          "condition_type": "land_level_check",
          "operator": ">=",
          "value": 3
        }
      ]
    }
  }
}
```

---

## å®Ÿè£…ãƒ•ãƒ­ãƒ¼

### 1. BattleParticipantã¸ã®è¿½åŠ 

```gdscript
class_name BattleParticipant

# å·»ç‰©æ”»æ’ƒãƒ•ãƒ©ã‚°ï¼ˆè²«é€šã¨ã¯åˆ¥ç®¡ç†ï¼‰
var is_using_scroll: bool = false
```

### 2. ç„¡åŠ¹åŒ–ãƒã‚§ãƒƒã‚¯é–¢æ•°

```gdscript
# BattleSystem.gd
func _check_nullify(attacker: BattleParticipant, defender: BattleParticipant, context: Dictionary) -> Dictionary:
	"""
	ç„¡åŠ¹åŒ–åˆ¤å®šã‚’è¡Œã†
	
	Returns:
		{
			"is_nullified": bool,  // ç„¡åŠ¹åŒ–ã•ã‚ŒãŸã‹
			"reduction_rate": float  // è»½æ¸›ç‡ï¼ˆ0.0=å®Œå…¨ç„¡åŠ¹åŒ–ã€0.5=50%è»½æ¸›ï¼‰
		}
	"""
	var ability_parsed = defender.creature_data.get("ability_parsed", {})
	var keywords = ability_parsed.get("keywords", [])
	
	if not "ç„¡åŠ¹åŒ–" in keywords:
		return {"is_nullified": false, "reduction_rate": 1.0}
	
	var keyword_conditions = ability_parsed.get("keyword_conditions", {})
	var nullify_condition = keyword_conditions.get("ç„¡åŠ¹åŒ–", {})
	
	# æ¡ä»¶ä»˜ãç„¡åŠ¹åŒ–ã®å ´åˆã€å…ˆã«æ¡ä»¶ã‚’ãƒã‚§ãƒƒã‚¯
	var conditions = nullify_condition.get("conditions", [])
	if conditions.size() > 0:
		var condition_checker = load("res://scripts/skills/condition_checker.gd").new()
		for condition in conditions:
			if not condition_checker.evaluate_condition(condition, context):
				return {"is_nullified": false, "reduction_rate": 1.0}
	
	# ç„¡åŠ¹åŒ–ã‚¿ã‚¤ãƒ—åˆ¥ã®åˆ¤å®š
	var nullify_type = nullify_condition.get("nullify_type", "")
	var is_nullified = false
	
	match nullify_type:
		"element":
			is_nullified = _check_nullify_element(nullify_condition, attacker)
		"mhp_above":
			is_nullified = _check_nullify_mhp_above(nullify_condition, attacker)
		"mhp_below":
			is_nullified = _check_nullify_mhp_below(nullify_condition, attacker)
		"st_below":
			is_nullified = _check_nullify_st_below(nullify_condition, attacker)
		"all_attacks":
			is_nullified = true  # ç„¡æ¡ä»¶ã§é©ç”¨
		"has_ability":
			is_nullified = _check_nullify_has_ability(nullify_condition, attacker)
		"scroll_attack":
			is_nullified = attacker.is_using_scroll
		"normal_attack":
			is_nullified = not attacker.is_using_scroll
	
	if is_nullified:
		var reduction_rate = nullify_condition.get("reduction_rate", 0.0)
		return {"is_nullified": true, "reduction_rate": reduction_rate}
	
	return {"is_nullified": false, "reduction_rate": 1.0}
```

### 3. å€‹åˆ¥ã®åˆ¤å®šé–¢æ•°

```gdscript
func _check_nullify_element(condition: Dictionary, attacker: BattleParticipant) -> bool:
	var attacker_element = attacker.creature_data.get("element", "")
	
	# å˜ä¸€å±æ€§
	if condition.has("element"):
		return attacker_element == condition.get("element")
	
	# è¤‡æ•°å±æ€§
	if condition.has("elements"):
		var elements = condition.get("elements", [])
		return attacker_element in elements
	
	return false

func _check_nullify_mhp_above(condition: Dictionary, attacker: BattleParticipant) -> bool:
	var threshold = condition.get("value", 0)
	var attacker_max_hp = attacker.creature_data.get("hp", 0)
	return attacker_max_hp >= threshold

func _check_nullify_mhp_below(condition: Dictionary, attacker: BattleParticipant) -> bool:
	var threshold = condition.get("value", 0)
	var attacker_max_hp = attacker.creature_data.get("hp", 0)
	return attacker_max_hp <= threshold

func _check_nullify_st_below(condition: Dictionary, attacker: BattleParticipant) -> bool:
	var threshold = condition.get("value", 0)
	var attacker_base_st = attacker.creature_data.get("ap", 0)
	return attacker_base_st <= threshold

func _check_nullify_has_ability(condition: Dictionary, attacker: BattleParticipant) -> bool:
	var ability = condition.get("ability", "")
	var attacker_keywords = attacker.creature_data.get("ability_parsed", {}).get("keywords", [])
	return ability in attacker_keywords
```

### 4. ãƒ€ãƒ¡ãƒ¼ã‚¸å‡¦ç†ã¸ã®çµ±åˆ

```gdscript
func _execute_attack_sequence(attack_order: Array, context: Dictionary) -> void:
	for i in range(attack_order.size()):
		var attacker_p = attack_order[i]
		var defender_p = attack_order[(i + 1) % 2]
		
		if not attacker_p.is_alive():
			continue
		
		# æ”»æ’ƒå›æ•°åˆ†ãƒ«ãƒ¼ãƒ—
		for attack_num in range(attacker_p.attack_count):
			if not defender_p.is_alive():
				break
			
			# ç„¡åŠ¹åŒ–åˆ¤å®š
			var nullify_result = _check_nullify(attacker_p, defender_p, context)
			
			if nullify_result["is_nullified"]:
				var reduction_rate = nullify_result["reduction_rate"]
				
				if reduction_rate == 0.0:
					# å®Œå…¨ç„¡åŠ¹åŒ–
					print("ã€ç„¡åŠ¹åŒ–ã€‘", defender_p.creature_data.get("name"), " ãŒæ”»æ’ƒã‚’ç„¡åŠ¹åŒ–")
					continue  # ãƒ€ãƒ¡ãƒ¼ã‚¸å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—
				else:
					# è»½æ¸›
					var original_damage = attacker_p.current_ap
					var reduced_damage = int(original_damage * reduction_rate)
					print("ã€è»½æ¸›ã€‘", defender_p.creature_data.get("name"), 
						  " ãŒãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’è»½æ¸› ", original_damage, " â†’ ", reduced_damage)
					defender_p.take_damage(reduced_damage)
			else:
				# é€šå¸¸ãƒ€ãƒ¡ãƒ¼ã‚¸
				defender_p.take_damage(attacker_p.current_ap)
			
			# å³æ­»åˆ¤å®šï¼ˆç„¡åŠ¹åŒ–æˆåŠŸæ™‚ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¦ã„ã‚‹ï¼‰
			if not nullify_result["is_nullified"]:
				_check_instant_death(attacker_p, defender_p)
```

---

## ä»–ã‚¹ã‚­ãƒ«ã¨ã®ç›¸äº’ä½œç”¨

### ç„¡åŠ¹åŒ– vs å³æ­»

```
ç„¡åŠ¹åŒ–æˆåŠŸ â†’ å³æ­»åˆ¤å®šã‚¹ã‚­ãƒƒãƒ—
ç„¡åŠ¹åŒ–å¤±æ•— â†’ é€šå¸¸é€šã‚Šå³æ­»åˆ¤å®š
```

### ç„¡åŠ¹åŒ– vs è²«é€š

```
ç„¡åŠ¹åŒ–ãŒå„ªå…ˆï¼ˆæ”»æ’ƒè‡ªä½“ãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ãŸã‚ã€è²«é€šã®å‡¦ç†ã«ã‚‚åˆ°é”ã—ãªã„ï¼‰
```

### ç„¡åŠ¹åŒ– vs å…ˆåˆ¶

```
æ”»æ’ƒé †ã«ã¯å½±éŸ¿ãªã—ï¼ˆå…ˆåˆ¶æ”»æ’ƒã§ã‚‚ç„¡åŠ¹åŒ–åˆ¤å®šã¯è¡Œã‚ã‚Œã‚‹ï¼‰
```

### ç„¡åŠ¹åŒ– vs 2å›æ”»æ’ƒ

```
å„æ”»æ’ƒã”ã¨ã«ç„¡åŠ¹åŒ–åˆ¤å®š
ï¼ˆç¢ºç‡è»½æ¸›ã®å ´åˆã€1å›ç›®ã¯è»½æ¸›ã€2å›ç›®ã¯é€šå¸¸ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚‚ã‚ã‚Šå¾—ã‚‹ï¼‰
```

### ç„¡åŠ¹åŒ– vs å¼·æ‰“

```
ç„¡åŠ¹åŒ–ãŒå„ªå…ˆï¼ˆå¼·æ‰“ã§å¢—å¹…ã•ã‚ŒãŸAPã§ã‚‚ç„¡åŠ¹åŒ–ã•ã‚Œã‚Œã°0ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼‰
```

---

## å®Ÿè£…ã®å„ªå…ˆé †ä½

### âœ… Phase 1-3: å…¨å®Ÿè£…å®Œäº†ï¼ˆ2025/10/20ï¼‰

#### Phase 1: åŸºæœ¬ç„¡åŠ¹åŒ–
1. âœ… **å±æ€§ç„¡åŠ¹åŒ–** - ã‚¤ã‚¨ãƒ†ã‚£ã€ãƒ€ãƒ³ãƒ”ãƒ¼ãƒ«ã€ã‚»ã‚¤ãƒ³ãƒˆ
2. âœ… **MHPæ¡ä»¶ç„¡åŠ¹åŒ–** - ã‚·ã‚°ãƒ«ãƒ‰

#### Phase 2: ãƒ‡ãƒ¼ã‚¿è¿½åŠ  + å®Ÿè£…
3. âœ… **è¤‡æ•°å±æ€§ç„¡åŠ¹åŒ–** - ã‚¢ãƒ¼ãƒãƒ¼ãƒŠã‚¤ãƒˆã€ã‚¢ã‚¯ã‚¢ãƒ‰ãƒ©ã‚´ãƒ³ã€ãƒŸã‚¹ãƒˆã‚¦ã‚£ãƒ³ã‚°
4. âœ… **MHP30ä»¥ä¸‹ç„¡åŠ¹åŒ–** - ã‚¢ã‚¯ã‚¢ãƒªãƒ³ã‚°
5. âœ… **STæ¡ä»¶ç„¡åŠ¹åŒ–** - ã‚·ãƒ¼ãƒ›ãƒ¼ã‚¹ã€ãƒ©ãƒãƒ–
6. âœ… **å…¨æ”»æ’ƒè»½æ¸›** - ã‚¬ã‚¹ã‚¯ãƒ©ã‚¦ãƒ‰ï¼ˆæœªãƒ‡ãƒ¼ã‚¿åŒ–ï¼‰
7. âœ… **èƒ½åŠ›æŒã¡ç„¡åŠ¹åŒ–** - ã‚°ãƒ¬ãƒ¼ãƒˆã‚¿ã‚¹ã‚«ãƒ¼

#### Phase 3: å·»ç‰©å®Ÿè£…
8. âœ… **å·»ç‰©æ”»æ’ƒã‚·ã‚¹ãƒ†ãƒ ** - is_using_scrollãƒ•ãƒ©ã‚°å®Ÿè£…
9. âœ… **å·»ç‰©æ”»æ’ƒç„¡åŠ¹åŒ–** - ã‚¢ãƒ¼ãƒ ãƒ‰ãƒ‘ãƒ©ãƒ‡ã‚£ãƒ³ã€ã‚¤ãƒ‰ã€ä»–8ä½“
10. âœ… **é€šå¸¸æ”»æ’ƒç„¡åŠ¹åŒ–** - ã‚¢ã‚¯ã‚¢ãƒ‡ãƒ¥ãƒ¼ã‚¯ã€ã‚¢ãƒ–ã‚µã‚¹

**å®Ÿè£…å®Œäº†ç¯„å›²**:
- å…¨ç„¡åŠ¹åŒ–ã‚¿ã‚¤ãƒ—å®Ÿè£…ï¼ˆ9ç¨®é¡ï¼‰
- ç„¡åŠ¹åŒ–æŒã¡ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ãƒ‡ãƒ¼ã‚¿æ•´å‚™ï¼ˆ26ä½“ï¼‰
- å·»ç‰©æ”»æ’ƒã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…
- æ¡ä»¶åˆ¤å®šã‚·ã‚¹ãƒ†ãƒ çµ±åˆ

### ğŸ”¶ æœªå®Ÿè£…ï¼ˆå°†æ¥å®Ÿè£…äºˆå®šï¼‰

**æ¡ä»¶ã‚¿ã‚¤ãƒ—è¿½åŠ ãŒå¿…è¦**:
- `item_equipped` æ¡ä»¶ (ä¾‹: ID 103 ã‚¢ã‚¯ã‚¢ãƒ‡ãƒ¥ãƒ¼ã‚¯ - é˜²å…·ä½¿ç”¨æ™‚)
- `land_level_check` æ¡ä»¶ (ä¾‹: ID 106 ã‚¢ãƒ–ã‚µã‚¹ - æˆ¦é—˜åœ°ãƒ¬ãƒ™ãƒ«3ä»¥ä¸Š)

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|-----------|---------|
| 2025/10/20 | 1.0 | åˆç‰ˆä½œæˆ - ç„¡åŠ¹åŒ–ã‚¹ã‚­ãƒ«ã®å…¨ä½“è¨­è¨ˆ |
| 2025/10/20 | 2.0 | å®Ÿè£…å®Œäº† - å…¨Phaseå®Œäº†ã€26ä½“ã®ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ãƒ‡ãƒ¼ã‚¿æ•´å‚™ |

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ20æ—¥ï¼ˆv2.0 - å®Ÿè£…å®Œäº†ï¼‰
