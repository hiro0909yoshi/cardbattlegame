# ç§˜è¡“ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: ã‚«ãƒ«ãƒ‰ã‚»ãƒ—ãƒˆé¢¨ã‚«ãƒ¼ãƒ‰ãƒãƒˆãƒ«ã‚²ãƒ¼ãƒ   
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ24æ—¥

---

## ðŸ“‹ ç›®æ¬¡

1. [ç§˜è¡“ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#ç§˜è¡“ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ç§˜è¡“ã¨ã‚¹ãƒšãƒ«ã®é–¢ä¿‚](#ç§˜è¡“ã¨ã‚¹ãƒšãƒ«ã®é–¢ä¿‚)
3. [ãƒ‡ãƒ¼ã‚¿æ§‹é€ ](#ãƒ‡ãƒ¼ã‚¿æ§‹é€ )
4. [å®Ÿè£…ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#å®Ÿè£…ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
5. [ç§˜è¡“ã®å®Ÿè¡Œãƒ•ãƒ­ãƒ¼](#ç§˜è¡“ã®å®Ÿè¡Œãƒ•ãƒ­ãƒ¼)
6. [ç§˜è¡“ã‚«ãƒ¼ãƒ‰ä¸€è¦§](#ç§˜è¡“ã‚«ãƒ¼ãƒ‰ä¸€è¦§)
7. [å®Ÿè£…è¨ˆç”»](#å®Ÿè£…è¨ˆç”»)
8. [å¤‰æ›´å±¥æ­´](#å¤‰æ›´å±¥æ­´)

---

## ç§˜è¡“ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### åŸºæœ¬å®šç¾©

ç§˜è¡“ï¼ˆMystic Artsï¼‰ã¯ã€ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ãŒæŒã¤ç‰¹æ®Šãªé­”æ³•åŠ¹æžœã€‚ã‚¹ãƒšãƒ«ãƒ•ã‚§ãƒ¼ã‚ºã§ç™ºå‹•ã§ãã€ã‚³ã‚¹ãƒˆã¨ã—ã¦é­”åŠ›ã‚’æ¶ˆè²»ã™ã‚‹ã€‚ã‚¹ãƒšãƒ«ã‚«ãƒ¼ãƒ‰ã¨æŽ’ä»–çš„ã§ã€åŒã˜ã‚¿ãƒ¼ãƒ³ã«ä¸¡æ–¹ã¯ä½¿ãˆãªã„ã€‚

### ç‰¹å¾´

- **ç™ºå‹•è€…**: è‡ªåˆ†ã®ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ã®ã¿
- **ã‚³ã‚¹ãƒˆ**: é­”åŠ›ï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å…±é€šè³‡æºï¼‰
- **ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: ã‚¹ãƒšãƒ«ãƒ•ã‚§ãƒ¼ã‚ºå†…ï¼ˆã‚¿ãƒ¼ãƒ³1å›žï¼‰
- **æŽ’ä»–æ€§**: ã‚¹ãƒšãƒ«ã‚«ãƒ¼ãƒ‰ä½¿ç”¨æ™‚ã¯ç§˜è¡“ã¯ä½¿ãˆãªã„ï¼ˆãã®é€†ã‚‚åŒã˜ï¼‰
- **ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ**: ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ã«çµ±åˆï¼ˆcreature/land/player/worldï¼‰
- **åŠ¹æžœ**: æ—¢å­˜ã®ã‚¹ãƒšãƒ«åŠ¹æžœã‚·ã‚¹ãƒ†ãƒ ã‚’æµç”¨

### ã‚·ã‚¹ãƒ†ãƒ è²¬ä»»åˆ†é›¢

```
ãƒžãƒƒãƒ—å´ (effect_manager.gd)
  â”œâ”€ ç§˜è¡“ã®æœ‰åŠ¹æ€§åˆ¤å®š
  â”œâ”€ ç§˜è¡“ã®å®Ÿè¡Œå¯å¦ãƒã‚§ãƒƒã‚¯
  â””â”€ ç§˜è¡“ã®åŠ¹æžœé©ç”¨

ã‚¹ãƒšãƒ«ãƒ•ã‚§ãƒ¼ã‚ºå´ (spell_phase_handler.gd)
  â”œâ”€ [ç§˜è¡“ã‚’ä½¿ã†]ãƒœã‚¿ãƒ³è¡¨ç¤ºåˆ¶å¾¡
  â”œâ”€ ç§˜è¡“ã®é¸æŠžUI
  â”œâ”€ ç§˜è¡“ã¨é€šå¸¸ã‚¹ãƒšãƒ«ã®æŽ’ä»–åˆ¶å¾¡
  â””â”€ ç§˜è¡“ã®å®Ÿè¡Œãƒ•ãƒ­ãƒ¼
```

---

## ç§˜è¡“ã¨ã‚¹ãƒšãƒ«ã®é–¢ä¿‚

### å…±é€šç‚¹

| é …ç›® | ç§˜è¡“ | ã‚¹ãƒšãƒ« |
|------|------|--------|
| åŠ¹æžœã‚¿ã‚¤ãƒ— | `effect_type`ã‚’ä½¿ç”¨ | `effect_type`ã‚’ä½¿ç”¨ |
| ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ  | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ  |
| å®Ÿè¡Œãƒ­ã‚¸ãƒƒã‚¯ | `spell_phase_handler.gd` | `spell_phase_handler.gd` |

### ç›¸é•ç‚¹

| é …ç›® | ç§˜è¡“ | ã‚¹ãƒšãƒ« |
|------|------|--------|
| ä¿æŒè€… | ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ï¼ˆ`ability_parsed.mystic_arts`) | æ‰‹æœ­ï¼ˆ`card_data.effect_parsed`) |
| ç™ºå‹•è€… | ç‰¹å®šã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ | ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å…¨å“¡ |
| ã‚³ã‚¹ãƒˆ | å…±é€šè³‡æºï¼ˆé­”åŠ›ï¼‰ | å…±é€šè³‡æºï¼ˆé­”åŠ›ï¼‰ |
| æœ‰åŠ¹æœŸé–“ | ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ãŒç”Ÿå­˜ä¸­ | ä½¿ç”¨æ™‚ç‚¹ã®ã¿ |
| æŽ’ä»–æ€§ | ã‚¹ãƒšãƒ«ã‚«ãƒ¼ãƒ‰ã¨æŽ’ä»–çš„ | ç§˜è¡“ã¨ã¯éžæŽ’ä»–çš„ âœ… |
| ä¸Šæ›¸ã | å¯èƒ½ï¼ˆåŒåç§˜è¡“ï¼‰ | å¯èƒ½ï¼ˆåŒåã‚¹ãƒšãƒ«ï¼‰ |

**é‡è¦**: ã‚¹ãƒšãƒ«ã¨ç§˜è¡“ã¯åŒã‚¿ãƒ¼ãƒ³ã«ä¸¡æ–¹ã¯ä½¿ãˆãªã„ã€‚ãŸã ã—ã€è¤‡æ•°ã®ç§˜è¡“ã‚’åŒæ™‚ã«ç™ºå‹•ã™ã‚‹ã“ã¨ã¯å¯èƒ½ï¼ˆå„ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ãŒç•°ãªã‚‹ç§˜è¡“ã‚’æŒã¤å ´åˆï¼‰ã€‚

### ã‚»ãƒ«ãƒ•ã‚¿ãƒ¼ã‚²ãƒƒãƒˆç§˜è¡“ï¼ˆtarget_filter: "self"ï¼‰

ã‚¹ãƒšãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¨åŒã˜ãã€è‡ªå‹•å¯¾è±¡ã®ç§˜è¡“ã«å¯¾å¿œã—ã¾ã™ã€‚ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠžUIã‚’è¡¨ç¤ºã›ãšã€ç§˜è¡“ã‚’ç™ºå‹•è€…ï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼‰ã¾ãŸã¯ãã®ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ã«è‡ªå‹•çš„ã«é©ç”¨ã—ã¾ã™ã€‚

**ä¾‹ï¼šã€Œé­‚åŽé›†ã€ï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è‡ªèº«ãŒå¯¾è±¡ï¼‰**

```json
{
  "target_type": "player",
  "target_filter": "self",
  "effects": [
    {
      "effect_type": "soul_collect",
      "description": "ä½¿ç”¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é­‚ãƒã‚¤ãƒ³ãƒˆ+10"
    }
  ]
}
```

**ä¾‹ï¼šã€Œè‡ªå·±å¼·åŒ–ã€ï¼ˆã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼è‡ªèº«ãŒå¯¾è±¡ï¼‰**

```json
{
  "target_type": "creature",
  "target_filter": "self",
  "effects": [
    {
      "effect_type": "stat_bonus",
      "ap_bonus": 5,
      "duration": 3
    }
  ]
}
```

å®Ÿè£…æ™‚ã®å‡¦ç†ï¼š`target_filter == "self"`ã®å ´åˆã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠžUIã‚’è¡¨ç¤ºã›ãšã€ç™ºå‹•å…ƒã«è‡ªå‹•è¨­å®šã—ã¾ã™ã€‚

### å®Ÿè¡Œåˆ¶å¾¡ãƒ•ãƒ­ãƒ¼

```
ã‚¹ãƒšãƒ«ãƒ•ã‚§ãƒ¼ã‚ºé–‹å§‹
  â”‚
  â”œâ”€ [ã‚¹ãƒšãƒ«ã‚«ãƒ¼ãƒ‰ä½¿ç”¨] é¸æŠž
  â”‚   â”œâ”€ ã‚¹ãƒšãƒ«ã‚’ç™ºå‹•
  â”‚   â””â”€ ç§˜è¡“UIã‚’éžè¡¨ç¤ºã«ï¼ˆæŽ’ä»–åˆ¶å¾¡ï¼‰
  â”‚
  â”œâ”€ [ç§˜è¡“ã‚’ä½¿ã†] é¸æŠž
  â”‚   â”œâ”€ ç™ºå‹•å¯èƒ½ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ã‚’åˆ—æŒ™
  â”‚   â”œâ”€ ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼é¸æŠžUIè¡¨ç¤º
  â”‚   â”œâ”€ ç§˜è¡“åŠ¹æžœã‚’é¸æŠž
  â”‚   â”œâ”€ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠžUIè¡¨ç¤ºï¼ˆã‚»ãƒ«ãƒ•ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ™‚ã¯éžè¡¨ç¤ºï¼‰
  â”‚   â”œâ”€ ç§˜è¡“ã‚’ç™ºå‹•
  â”‚   â””â”€ ã‚¹ãƒšãƒ«UIã‚’éžè¡¨ç¤ºã«ï¼ˆæŽ’ä»–åˆ¶å¾¡ï¼‰
  â”‚
  â””â”€ [ã‚¹ãƒšãƒ«ã‚’ã—ãªã„] é¸æŠž
      â””â”€ ã‚¹ãƒšãƒ«ãƒ•ã‚§ãƒ¼ã‚ºçµ‚äº†
```

---

## ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### creature_dataã¸ã®ç§˜è¡“å®šç¾©

ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ã‚«ãƒ¼ãƒ‰ã®`ability_parsed`ã«`mystic_arts`é…åˆ—ã‚’è¿½åŠ ã€‚

```json
{
  "id": 1,
  "name": "ã‚¢ãƒ¢ãƒ³",
  "hp": 30,
  "ap": 20,
  "ability_parsed": {
    "skills": [...],
    "effects": [...],
    "mystic_arts": [
      {
        "id": "mystic_001",
        "name": "ãƒ‡ãƒƒã‚­ç ´å£Š",
        "description": "å¯¾è±¡ãƒ–ãƒƒã‚¯ã®ä¸Š1æžšã‚’ç ´å£Šã™ã‚‹",
        "cost": 50,
        "target_type": "player",
        "target_filter": "enemy",
        "effects": [
          {
            "effect_type": "destroy_deck_top",
            "target": "player",
            "value": 1,
            "description": "å¯¾è±¡ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ‡ãƒƒã‚­ä¸Š1æžšç ´å£Š"
          }
        ]
      }
    ]
  }
}
```

### ç§˜è¡“ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ 

```gdscript
{
  "id": "mystic_unique_id",            # ç§˜è¡“ã®ä¸€æ„ID
  "name": "ãƒ‡ãƒƒã‚­ç ´å£Š",                # ç§˜è¡“å
  "description": "...",                # èª¬æ˜Žãƒ†ã‚­ã‚¹ãƒˆ
  "cost": 50,                          # é­”åŠ›ã‚³ã‚¹ãƒˆ
  "target_type": "player",             # ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¿ã‚¤ãƒ—
  "target_filter": "enemy",            # ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
  "effects": [                         # åŠ¹æžœé…åˆ—ï¼ˆã‚¹ãƒšãƒ«ã¨åŒã˜ï¼‰
    {
      "effect_type": "...",
      "target": "...",
      "value": ...
    }
  ],
  "caster_creature_id": 1,             # ç§˜è¡“ã‚’æŒã¤ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼IDï¼ˆå®Ÿè¡Œæ™‚ã«è¨­å®šï¼‰
  "caster_tile_index": 5               # ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ã®ä½ç½®ï¼ˆå®Ÿè¡Œæ™‚ã«è¨­å®šï¼‰
}
```

### JSONå®šç¾©ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

ç§˜è¡“ã¯ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ã‚«ãƒ¼ãƒ‰ã®`ability_parsed`ã«çµ±åˆã•ã‚Œã‚‹ã€‚è¤‡æ•°ã®ç§˜è¡“ã‚’æŒã¤ã‚¯ãƒªãƒ¼ãƒãƒ£ã‚¢ã‚‚å¯èƒ½ã€‚

```json
{
  "id": 23,
  "name": "ãƒ‰ã‚¥ãƒ¼ãƒ ãƒ‡ãƒœãƒ©ãƒ¼",
  "ability_parsed": {
    "mystic_arts": [
      {
        "id": "mystic_001",
        "name": "å‘ªã„ã®ä¸€æ’ƒ",
        "cost": 60,
        "target_type": "creature",
        "target_filter": "enemy",
        "effects": [
          {
            "effect_type": "curse_attack",
            "value": 30,
            "duration": 3
          }
        ]
      },
      {
        "id": "mystic_002",
        "name": "é­‚åŽé›†",
        "cost": 40,
        "target_type": "player",
        "target_filter": "self",
        "effects": [
          {
            "effect_type": "soul_collect"
          }
        ]
      }
    ]
  }
}
```

---

## å®Ÿè£…ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

```
scripts/spells/
  â”œâ”€â”€ spell_mystic_arts.gd           # ç§˜è¡“å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆæ–°è¦ï¼‰
  â””â”€â”€ spell_phase_handler.gd         # ã‚¹ãƒšãƒ«ãƒ•ã‚§ãƒ¼ã‚ºå‡¦ç†ï¼ˆä¿®æ­£ï¼‰

scripts/game_flow/
  â””â”€â”€ spell_phase_handler.gd         # ç§˜è¡“ç™ºå‹•ãƒ•ãƒ­ãƒ¼è¿½åŠ 

ui_components/
  â””â”€â”€ spell_and_mystic_ui.gd         # ç§˜è¡“UIç®¡ç†ï¼ˆæ–°è¦ãƒ»ä¿®æ­£ï¼‰

docs/design/
  â”œâ”€â”€ mystic_arts_system.md          # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆä»•æ§˜æ›¸ï¼‰
  â””â”€â”€ mystic_arts_implementation.md  # å®Ÿè£…è¨­è¨ˆæ›¸
```

### SpellMysticArts ã‚¯ãƒ©ã‚¹

ç§˜è¡“ã®å®Ÿè¡Œãƒ­ã‚¸ãƒƒã‚¯ã‚’ç®¡ç†ã™ã‚‹æ–°ã—ã„ã‚¯ãƒ©ã‚¹ã€‚ã‚¹ãƒšãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¨åŒã˜æ§‹é€ ã‚’æŽ¡ç”¨ã€‚

```gdscript
class_name SpellMysticArts
extends Reference

func get_available_creatures(board_system, player_id) -> Array:
    """ç™ºå‹•å¯èƒ½ãªã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ã‚’å–å¾—"""
    pass

func get_mystic_arts_for_creature(creature_data) -> Array:
    """ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ãŒæŒã¤ç§˜è¡“ä¸€è¦§ã‚’å–å¾—"""
    pass

func can_cast_mystic_art(mystic_art, caster_creature_id, player_id, player_magic) -> bool:
    """ç§˜è¡“ç™ºå‹•å¯èƒ½ã‹åˆ¤å®š"""
    pass

func apply_mystic_art_effect(mystic_art, target_data, context) -> bool:
    """ç§˜è¡“åŠ¹æžœã‚’é©ç”¨"""
    pass
```

### SpellPhaseHandler ã¸ã®çµ±åˆ

æ—¢å­˜ã®`spell_phase_handler.gd`ã«ç§˜è¡“ç™ºå‹•ãƒ•ãƒ­ãƒ¼è¿½åŠ ã€‚

```gdscript
# æ—¢å­˜ãƒ¡ã‚½ãƒƒãƒ‰
func _handle_spell_phase() -> void
func _apply_single_effect(effect) -> bool

# ç§˜è¡“ç”¨ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆæ–°è¦è¿½åŠ ï¼‰
func _handle_mystic_arts_phase() -> void
func _select_mystic_arts_creature() -> void
func _select_mystic_art_effect() -> void
func _apply_mystic_art(mystic_art, target_data) -> bool
```

### UIãƒžãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®æ‹¡å¼µ

ã‚¹ãƒšãƒ«UIã¨ç§˜è¡“UIã®æŽ’ä»–åˆ¶å¾¡ã€‚

```gdscript
class_name SpellAndMysticUI
extends Control

# ã‚¹ãƒšãƒ«UIã¨ç§˜è¡“UIã‚’çµ±åˆç®¡ç†
func show_spell_ui() -> void
    """ã‚¹ãƒšãƒ«UIè¡¨ç¤ºã€ç§˜è¡“UIéžè¡¨ç¤º"""
    pass

func show_mystic_arts_ui() -> void
    """ç§˜è¡“UIè¡¨ç¤ºã€ã‚¹ãƒšãƒ«UIéžè¡¨ç¤º"""
    pass

func hide_all_spell_ui() -> void
    """å…¨ã‚¹ãƒšãƒ«/ç§˜è¡“UIéžè¡¨ç¤º"""
    pass
```

---

## ç§˜è¡“ã®å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

### ãƒ•ãƒ­ãƒ¼å›³

```
ç§˜è¡“å®Ÿè¡Œè¦æ±‚
  â”‚
  â”œâ”€ 1. ç™ºå‹•å¯èƒ½ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼å–å¾—
  â”‚       â”œâ”€ ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ãŒã‚¿ã‚¤ãƒ«ã«å­˜åœ¨ï¼Ÿ
  â”‚       â”œâ”€ ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ãŒç”Ÿå­˜ï¼Ÿ
  â”‚       â””â”€ ç§˜è¡“ã‚’æŒã¤ï¼Ÿ
  â”‚
  â”œâ”€ 2. ç™ºå‹•æ¡ä»¶ãƒã‚§ãƒƒã‚¯
  â”‚       â”œâ”€ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼é­”åŠ› >= ç§˜è¡“ã‚³ã‚¹ãƒˆï¼Ÿ
  â”‚       â”œâ”€ ã‚¹ãƒšãƒ«æœªä½¿ç”¨çŠ¶æ…‹ï¼Ÿ
  â”‚       â””â”€ ã‚¿ãƒ¼ãƒ³1å›žã®ã¿åˆ¶é™ã‚’ãƒã‚§ãƒƒã‚¯
  â”‚
  â”œâ”€ 3. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠž
  â”‚       â”œâ”€ target_typeã«å¿œã˜ã¦UIã‚’è¡¨ç¤º
  â”‚       â””â”€ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨
  â”‚
  â”œâ”€ 4. åŠ¹æžœé©ç”¨
  â”‚       â”œâ”€ effect_typeã«å¿œã˜ã¦å‡¦ç†
  â”‚       â”œâ”€ æ¡ä»¶ãƒã‚§ãƒƒã‚¯ï¼ˆå¿…è¦ãªå ´åˆï¼‰
  â”‚       â””â”€ çµæžœã‚’ãƒ­ã‚°ã«è¨˜éŒ²
  â”‚
  â””â”€ 5. å®Œäº†å‡¦ç†
          â”œâ”€ é­”åŠ›æ¶ˆè²»
          â”œâ”€ ã‚¿ãƒ¼ãƒ³å†…ä½¿ç”¨ãƒ•ãƒ©ã‚°ã‚»ãƒƒãƒˆ
          â””â”€ UIãƒªã‚»ãƒƒãƒˆ
```

### ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠžã®å‡¦ç†

ç§˜è¡“ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠžã¯æ—¢å­˜ã®`TargetSelectionHelper`ã‚’ä½¿ç”¨ã€‚

```gdscript
# target_typeã«å¿œã˜ãŸã‚¿ãƒ¼ã‚²ãƒƒãƒˆå–å¾—
var valid_targets = _get_valid_targets(mystic_art["target_type"], 
                                       mystic_art["target_filter"])

# ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¸æŠžUIè¡¨ç¤º
var selected_target = await target_selection_helper.select_target(valid_targets)

# ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆ
var target_data = {
    "type": mystic_art["target_type"],
    "selected": selected_target
}
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```gdscript
# ç§˜è¡“ç™ºå‹•ä¸å¯ã®ç†ç”±ã‚’åˆ¤å®š
func _get_mystic_art_error(mystic_art, context) -> String:
    if context.player_magic < mystic_art["cost"]:
        return "é­”åŠ›ä¸è¶³"
    
    if context.spell_used_this_turn:
        return "ã“ã®ã‚¿ãƒ¼ãƒ³ã¯ã‚¹ãƒšãƒ«ã‚’ä½¿ç”¨æ¸ˆã¿"
    
    if not _has_valid_target(mystic_art):
        return "æœ‰åŠ¹ãªã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒã‚ã‚Šã¾ã›ã‚“"
    
    return ""  # ã‚¨ãƒ©ãƒ¼ãªã—
```

---

## ç§˜è¡“ã‚«ãƒ¼ãƒ‰ä¸€è¦§

### å®Ÿè£…äºˆå®šã®ç§˜è¡“

| ID | ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ | ç§˜è¡“å | ã‚³ã‚¹ãƒˆ | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ | åŠ¹æžœæ¦‚è¦ | çŠ¶æ…‹ |
|----|-----------|----|-------|----------|--------|------|
| 1 | ãƒ‰ã‚¥ãƒ¼ãƒ ãƒ‡ãƒœãƒ©ãƒ¼ | å‘ªã„ã®ä¸€æ’ƒ | 60 | creature | æ•µã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ã«å‘ªã„ã‚’ä»˜ä¸Ž | â³ |
| 2 | ãƒªãƒƒãƒ | ãƒ‡ãƒƒã‚­ç ´å£Š | 80 | player | æ•µã®ãƒ‡ãƒƒã‚­ä¸Š1æžšã‚’ç ´å£Š | â³ |
| 3 | ã‚­ãƒ¡ãƒ© | ãƒžãƒƒãƒ—å‘¨å›ž | 50 | self | ãƒžãƒƒãƒ—å‘¨å›žã‚«ã‚¦ãƒ³ãƒˆ+1 | â³ |
| ... | ... | ... | ... | ... | ... | ... |

**å‡¡ä¾‹**:
- `â³`: æœªå®Ÿè£…
- `âœ…`: å®Ÿè£…å®Œäº†
- `ðŸ”§`: ä¿®æ­£ä¸­

---

## å®Ÿè£…è¨ˆç”»

### Phase 1: åŸºç›¤æ§‹ç¯‰ï¼ˆæœ€å„ªå…ˆï¼‰

- [ ] `SpellMysticArts`ã‚¯ãƒ©ã‚¹ä½œæˆ
- [ ] `creature_data`ã¸ã®`mystic_arts`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ 
- [ ] ç§˜è¡“å–å¾—ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…
- [ ] ç§˜è¡“ç™ºå‹•å¯å¦åˆ¤å®šãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…

### Phase 2: ã‚¹ãƒšãƒ«ãƒ•ã‚§ãƒ¼ã‚ºçµ±åˆ

- [ ] `SpellPhaseHandler`ã«ç§˜è¡“ç™ºå‹•ãƒ•ãƒ­ãƒ¼è¿½åŠ 
- [ ] `TargetSelectionHelper`ã¨ã®çµ±åˆ
- [ ] ç§˜è¡“UIå®Ÿè£…ï¼ˆ[ç§˜è¡“ã‚’ä½¿ã†]ãƒœã‚¿ãƒ³ï¼‰
- [ ] æŽ’ä»–åˆ¶å¾¡å®Ÿè£…ï¼ˆã‚¹ãƒšãƒ«ã¨ã®æŽ’ä»–æ€§ï¼‰

### Phase 3: åŠ¹æžœå®Ÿè£…

- [ ] æ—¢å­˜`effect_type`ã®ç§˜è¡“æµç”¨
- [ ] ç§˜è¡“å°‚ç”¨`effect_type`ã®è¿½åŠ ï¼ˆå¿…è¦ãªå ´åˆï¼‰
- [ ] æ¡ä»¶ãƒã‚§ãƒƒã‚¯å‡¦ç†

### Phase 4: ç§˜è¡“ã‚«ãƒ¼ãƒ‰å®šç¾©

- [ ] JSONãƒ‡ãƒ¼ã‚¿ã«ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼ã®ç§˜è¡“ã‚’å®šç¾©
- [ ] ãƒ†ã‚¹ãƒˆãƒ—ãƒ¬ã‚¤ç”¨ã®ç§˜è¡“ã‚’è¤‡æ•°å®Ÿè£…

### Phase 5: ãƒ†ã‚¹ãƒˆã¨ãƒãƒ©ãƒ³ã‚¹èª¿æ•´

- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆ
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿæ–½
- [ ] ãƒãƒ©ãƒ³ã‚¹èª¿æ•´

---

## é–‹ç™ºè€…å‘ã‘ï¼šæ‹¡å¼µãƒ«ãƒ¼ãƒ«

### æ–°ã—ã„ç§˜è¡“ã‚’è¿½åŠ ã™ã‚‹å ´åˆ

#### å¿…é ˆæ›´æ–°ç®‡æ‰€

1. **ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼JSONãƒ‡ãƒ¼ã‚¿** (`data/*/element_*.json`)
   - `ability_parsed.mystic_arts`é…åˆ—ã«ç§˜è¡“ã‚’è¿½åŠ 

2. **é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ** (`docs/design/mystic_arts_system.md`)
   - ç§˜è¡“ã‚«ãƒ¼ãƒ‰ä¸€è¦§ã‚’æ›´æ–°

3. **å®Ÿè£…è¨­è¨ˆæ›¸** (`docs/design/mystic_arts_implementation.md`)
   - å¿…è¦ã«å¿œã˜ã¦å®Ÿè£…ä¸Šã®æ³¨æ„ã‚’è¿½è¨˜

### æ–°ã—ã„ç§˜è¡“å°‚ç”¨effect_typeã‚’è¿½åŠ ã™ã‚‹å ´åˆ

1. **`SpellMysticArts.gd`**
   - `apply_mystic_art_effect()`ã«æ–°ã—ã„ã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ 

2. **`spell_phase_handler.gd`**
   - `_apply_single_effect()`ã«ç§˜è¡“ç”¨ãƒ­ã‚¸ãƒƒã‚¯è¿½åŠ ï¼ˆå¿…è¦ãªå ´åˆï¼‰

3. **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°**
   - ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ç§˜è¡“ã‚«ãƒ¼ãƒ‰ä¸€è¦§ã«è¿½åŠ 
   - å®Ÿè£…è¨­è¨ˆæ›¸ã«è©³ç´°è¨˜è¼‰

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|-----------|---------|
| 2025/11/24 | 1.0 | åˆç‰ˆä½œæˆ - ã‚¹ãƒšãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ç¶™æ‰¿ |
| 2025/11/24 | 1.1 | ðŸ”§ ã‚»ãƒ«ãƒ•ã‚¿ãƒ¼ã‚²ãƒƒãƒˆç§˜è¡“ã‚’è¿½åŠ  - `target_filter: "self"`ã®å¯¾å¿œã‚’æ˜Žè¨˜ã€target_type/target_filterã®è©³ç´°èª¬æ˜Žè¿½åŠ  |

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ24æ—¥ï¼ˆv1.0 - åˆç‰ˆä½œæˆï¼‰
