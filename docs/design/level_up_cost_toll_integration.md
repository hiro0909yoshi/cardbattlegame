# ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆãƒ»é€šè¡Œæ–™çµ±åˆè¨­è¨ˆæ›¸

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.0  
**ä½œæˆæ—¥**: 2025å¹´11æœˆ23æ—¥  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: è¨­è¨ˆç¢ºå®š

---

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [æ–°è¨­è¨ˆæ–¹é‡](#æ–°è¨­è¨ˆæ–¹é‡)
3. [è¨ˆç®—å¼ã®çµ±ä¸€](#è¨ˆç®—å¼ã®çµ±ä¸€)
4. [ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆã®è¨ˆç®—æ–¹æ³•](#ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆã®è¨ˆç®—æ–¹æ³•)
5. [å®Ÿè£…ç®‡æ‰€ã®æ•´ç†](#å®Ÿè£…ç®‡æ‰€ã®æ•´ç†)
6. [ä¿®æ­£è¨ˆç”»](#ä¿®æ­£è¨ˆç”»)
7. [å®Ÿè£…ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³](#å®Ÿè£…ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³)

---

## æ¦‚è¦

ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆã‚’**é€šè¡Œæ–™ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰å‹•çš„ã«è¨ˆç®—ã™ã‚‹**ã‚ˆã†ã«çµ±åˆã™ã‚‹è¨­è¨ˆã€‚

**ç›®æ¨™**ï¼š
```
ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆ(Lv X) = é€šè¡Œæ–™è¨ˆç®—(é€£é–ãƒœãƒ¼ãƒŠã‚¹=1.5)
                          = 100 Ã— å±æ€§ä¿‚æ•° Ã— ãƒ¬ãƒ™ãƒ«ä¿‚æ•°[X] Ã— 1.5 Ã— ãƒãƒƒãƒ—ä¿‚æ•°
                          â†’ 10ã®ä½ã§åˆ‡ã‚Šæ¨ã¦
```

**ç¾åœ¨ã®å•é¡Œ**ï¼š
- ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆãŒ ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆLv.2: 80, Lv.3: 240, Lv.4: 620, Lv.5: 1200ï¼‰
- ãƒãƒƒãƒ—ã”ã¨ã®å·®åˆ†ãŒåæ˜ ã•ã‚Œã¦ã„ãªã„
- é€šè¡Œæ–™ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é–¢ä¿‚ãŒä¸æ˜ç¢º

**æ–°è¨­è¨ˆã®ãƒ¡ãƒªãƒƒãƒˆ**ï¼š
- âœ… é€šè¡Œæ–™ã‹ã‚‰å‹•çš„ã«è¨ˆç®—
- âœ… ãƒãƒƒãƒ—ã”ã¨ã«è‡ªå‹•å¤‰æ›´
- âœ… å˜ä¸€ã®è¨ˆç®—å¼ã§ç®¡ç†
- âœ… ãƒãƒ©ãƒ³ã‚¹èª¿æ•´ãŒå®¹æ˜“

---

## æ–°è¨­è¨ˆæ–¹é‡

### é€šè¡Œæ–™ Ã— é€£é–2 = ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆè¨ˆç®—                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚ ã‚³ã‚¹ãƒˆ = floor_toll(                               â”‚
â”‚   100 Ã— å±æ€§ä¿‚æ•°[tile.element]                    â”‚
â”‚       Ã— ãƒ¬ãƒ™ãƒ«ä¿‚æ•°[target_level]                   â”‚
â”‚       Ã— é€£é–ãƒœãƒ¼ãƒŠã‚¹(2å€‹ = 1.5)  â† å›ºå®šå€¤         â”‚
â”‚       Ã— ãƒãƒƒãƒ—ä¿‚æ•°[current_map]                    â”‚
â”‚ )                                                   â”‚
â”‚                                                      â”‚
â”‚ â€» 10ã®ä½ã§åˆ‡ã‚Šæ¨ã¦ï¼ˆfloor_tollä½¿ç”¨ï¼‰              â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…·ä½“ä¾‹ï¼ˆåŸºæº–ãƒãƒƒãƒ—map_1ã€ç«å±æ€§ã‚¿ã‚¤ãƒ«ï¼‰

```
å±æ€§ä¿‚æ•°: 1.0ï¼ˆç«ï¼‰
ãƒ¬ãƒ™ãƒ«ä¿‚æ•°: Lv.3 = 1.5
é€£é–ãƒœãƒ¼ãƒŠã‚¹: 1.5ï¼ˆå›ºå®šï¼‰
ãƒãƒƒãƒ—ä¿‚æ•°: 1.0ï¼ˆmap_1ï¼‰

Lv.3ã¸ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰:
100 Ã— 1.0 Ã— 1.5 Ã— 1.5 Ã— 1.0 = 225
â†’ åˆ‡ã‚Šæ¨ã¦ â†’ 220G

Lv.4ã¸ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰:
100 Ã— 1.0 Ã— 2.0 Ã— 1.5 Ã— 1.0 = 300
â†’ åˆ‡ã‚Šæ¨ã¦ â†’ 300G

Lv.5ã¸ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰:
100 Ã— 1.0 Ã— 2.5 Ã— 1.5 Ã— 1.0 = 375
â†’ åˆ‡ã‚Šæ¨ã¦ â†’ 370G
```

**ãƒãƒƒãƒ—ä¿‚æ•°ã®å½±éŸ¿**ï¼ˆMap2: 0.8ã€Map3: 1.2ï¼‰

```
Map2ï¼ˆ20%å®‰ï¼‰:
Lv.3: 100 Ã— 1.0 Ã— 1.5 Ã— 1.5 Ã— 0.8 = 180 â†’ 180G
Lv.4: 100 Ã— 1.0 Ã— 2.0 Ã— 1.5 Ã— 0.8 = 240 â†’ 240G

Map3ï¼ˆ20%é«˜ï¼‰:
Lv.3: 100 Ã— 1.0 Ã— 1.5 Ã— 1.5 Ã— 1.2 = 270 â†’ 270G
Lv.4: 100 Ã— 1.0 Ã— 2.0 Ã— 1.5 Ã— 1.2 = 360 â†’ 360G
```

---

## è¨ˆç®—å¼ã®çµ±ä¸€

### é€šè¡Œæ–™è¨ˆç®—ï¼ˆæ—¢å­˜ï¼‰

```gdscript
func calculate_toll(tile_index: int, map_id: String = "") -> int:
	var base = GameConstants.TOLL_BASE_AMOUNT  # 100
	var element_mult = GameConstants.TOLL_ELEMENT_MULTIPLIER.get(tile.tile_type, 1.0)
	var level_mult = GameConstants.TOLL_LEVEL_MULTIPLIER.get(tile.level, 1.0)
	var chain_bonus = calculate_chain_bonus(tile_index, tile.owner_id)
	var map_mult = GameConstants.TOLL_MAP_MULTIPLIER.get(map_id, 1.0)
	
	var raw_toll = base * element_mult * level_mult * chain_bonus * map_mult
	return GameConstants.floor_toll(raw_toll)  # 10ã®ä½ã§åˆ‡ã‚Šæ¨ã¦
```

### ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆè¨ˆç®—ï¼ˆæ–°è¦ï¼‰

```gdscript
func calculate_level_up_cost(tile_index: int, target_level: int, map_id: String = "") -> int:
	var base = GameConstants.TOLL_BASE_AMOUNT  # 100
	var tile = tile_nodes[tile_index]
	var element_mult = GameConstants.TOLL_ELEMENT_MULTIPLIER.get(tile.tile_type, 1.0)
	var level_mult = GameConstants.TOLL_LEVEL_MULTIPLIER.get(target_level, 1.0)
	var chain_bonus = 1.5  # å›ºå®šå€¤ï¼ˆé€£é–2å€‹ï¼‰
	var map_mult = GameConstants.TOLL_MAP_MULTIPLIER.get(map_id, 1.0)
	
	var raw_cost = base * element_mult * level_mult * chain_bonus * map_mult
	return GameConstants.floor_toll(raw_cost)  # 10ã®ä½ã§åˆ‡ã‚Šæ¨ã¦
```

**é‡è¦ãªé•ã„**ï¼š
- é€šè¡Œæ–™: å®Ÿéš›ã®ã‚¿ã‚¤ãƒ«ã®é€£é–ãƒœãƒ¼ãƒŠã‚¹ã‚’ä½¿ç”¨
- ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆ: å›ºå®šå€¤1.5ï¼ˆé€£é–2å€‹ç›¸å½“ï¼‰ã‚’å¸¸ã«ä½¿ç”¨

---

## ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆã®è¨ˆç®—æ–¹æ³•

### ç¾åœ¨ã®å®Ÿè£…ï¼ˆãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ï¼‰

```gdscript
# land_command_ui.gdï¼ˆ183, 238, 315è¡Œï¼‰
var level_costs = {0: 0, 1: 0, 2: 80, 3: 240, 4: 620, 5: 1200}
```

### æ–°ã—ã„å®Ÿè£…ï¼ˆå‹•çš„è¨ˆç®—ï¼‰

**1. TileDataManager ã«æ–°ã—ã„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ **

```gdscript
func calculate_level_up_cost(tile_index: int, target_level: int, map_id: String = "") -> int:
	if not tile_nodes.has(tile_index):
		return 0
	
	if target_level < 2 or target_level > GameConstants.MAX_LEVEL:
		return 0
	
	var base = GameConstants.TOLL_BASE_AMOUNT
	var tile = tile_nodes[tile_index]
	var element_mult = GameConstants.TOLL_ELEMENT_MULTIPLIER.get(tile.tile_type, 1.0)
	var level_mult = GameConstants.TOLL_LEVEL_MULTIPLIER.get(target_level, 1.0)
	var chain_bonus = 1.5  # é€£é–2å€‹ï¼ˆå›ºå®šï¼‰
	var map_mult = 1.0
	
	if map_id != "" and GameConstants.TOLL_MAP_MULTIPLIER.has(map_id):
		map_mult = GameConstants.TOLL_MAP_MULTIPLIER[map_id]
	
	var raw_cost = base * element_mult * level_mult * chain_bonus * map_mult
	return GameConstants.floor_toll(raw_cost)
```

**2. land_command_ui.gd ã‹ã‚‰å‘¼ã³å‡ºã™**

```gdscript
func _calculate_level_up_cost(tile_index: int, from_level: int, to_level: int, map_id: String = "") -> int:
	# TileDataManagerã‹ã‚‰è¨ˆç®—çµæœã‚’å–å¾—
	return board_system_ref.tile_data_manager.calculate_level_up_cost(tile_index, to_level, map_id)
```

---

## å®Ÿè£…ç®‡æ‰€ã®æ•´ç†

### ç¾åœ¨ã®æ•£åœ¨ç®‡æ‰€

```
1ï¸âƒ£  land_command_ui.gdï¼ˆ3ç®‡æ‰€ï¼‰
    â”œâ”€ show_level_selection() - line 183
    â”‚  var level_costs = {0: 0, 1: 0, 2: 80, 3: 240, 4: 620, 5: 1200}
    â”œâ”€ create_level_selection_panel() - line 238
    â”‚  var level_costs = {2: 80, 3: 240, 4: 620, 5: 1200}
    â””â”€ _calculate_level_up_cost() - line 315
       var level_costs = {0: 0, 1: 0, 2: 80, 3: 240, 4: 620, 5: 1200}

2ï¸âƒ£  GameConstants.gd
    â””â”€ LEVEL_VALUES: ç´¯ç©å€¤ {1:0, 2:80, 3:340, 4:960, 5:2160}
```

### ä¿®æ­£å¾Œã®é›†ç´„

```
1ï¸âƒ£  TileDataManager.gdï¼ˆæ–°è¦ï¼‰
    â””â”€ calculate_level_up_cost(tile_index, target_level, map_id)
       â†’ é€šè¡Œæ–™è¨ˆç®—å¼ã‚’ä½¿ç”¨ã—ã¦å‹•çš„ã«è¨ˆç®—

2ï¸âƒ£  land_command_ui.gdï¼ˆä¿®æ­£ï¼‰
    â”œâ”€ show_level_selection()
    â”‚  â†’ board_system_ref.tile_data_manager.calculate_level_up_cost() ã‚’å‘¼ã³å‡ºã™
    â”œâ”€ create_level_selection_panel()
    â”‚  â†’ åŒä¸Š
    â””â”€ _calculate_level_up_cost()
       â†’ åŒä¸Š

3ï¸âƒ£  GameConstants.gd
    â”œâ”€ TOLL_BASE_AMOUNT: 100
    â”œâ”€ TOLL_ELEMENT_MULTIPLIER: {...}
    â”œâ”€ TOLL_LEVEL_MULTIPLIER: {...}
    â”œâ”€ TOLL_MAP_MULTIPLIER: {...}
    â””â”€ floor_toll(): 10ã®ä½ã§åˆ‡ã‚Šæ¨ã¦é–¢æ•°
```

---

## æ³¨æ„äº‹é …ï¼ˆé€šè¡Œæ–™æ”¯æ‰•ã„ä¸€æœ¬åŒ–ã«ã‚ˆã‚‹å¤‰æ›´ï¼‰

### 2025/11/23 ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ

**ãƒãƒˆãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®æ”¯æ‰•ã„å‡¦ç†å‰Šé™¤**:
- `battle_system.gd` ã® `pay_toll_3d()` ã‚’å‰Šé™¤äºˆå®š
- ãƒãƒˆãƒ«çµæœï¼ˆæ•—åŒ—ï¼‰å¾Œã®æ”¯æ‰•ã„ã¯ `tile_action_processor.gd` ã«ä¸€æœ¬åŒ–
- ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆã®è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã¯å¤‰æ›´ãªã—

**å¯¾è±¡å¤–**:
- ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆlevel_up_cost_toll_integration.mdï¼‰ã®å†…å®¹ã¯å¤‰æ›´ãªã—
- ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆè¨ˆç®—ã¯æ”¯æ‰•ã„å‡¦ç†ã¨ã¯ç‹¬ç«‹

---

## ä¿®æ­£è¨ˆç”»

### Phase 1: GameConstants ã®æ‹¡å¼µï¼ˆç¢ºèªãƒ»è¿½åŠ ï¼‰

**æ—¢å­˜ã®å®šæ•°ã‚’ç¢ºèª**
```gdscript
const TOLL_BASE_AMOUNT = 100
const TOLL_ELEMENT_MULTIPLIER = {
	"fire": 1.0,
	"water": 1.0,
	"wind": 1.0,
	"earth": 1.0,
	"none": 0.8
}
const TOLL_LEVEL_MULTIPLIER = {
	1: 1.0,
	2: 1.2,
	3: 1.5,
	4: 2.0,
	5: 2.5
}
const TOLL_MAP_MULTIPLIER = {
	# ãƒãƒƒãƒ—ä¿‚æ•°ã‚’æ±ºå®šæ™‚ã«è¿½åŠ 
}

# ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
static func floor_toll(amount: float) -> int:
	return int(floor(amount / 10.0) * 10.0)
```

### Phase 2: TileDataManager.gd ã« calculate_level_up_cost() ã‚’è¿½åŠ 

```gdscript
func calculate_level_up_cost(tile_index: int, target_level: int, map_id: String = "") -> int:
	if not tile_nodes.has(tile_index):
		return 0
	
	if target_level < 2 or target_level > GameConstants.MAX_LEVEL:
		return 0
	
	var base = GameConstants.TOLL_BASE_AMOUNT
	var tile = tile_nodes[tile_index]
	var element_mult = GameConstants.TOLL_ELEMENT_MULTIPLIER.get(tile.tile_type, 1.0)
	var level_mult = GameConstants.TOLL_LEVEL_MULTIPLIER.get(target_level, 1.0)
	var chain_bonus = 1.5  # é€£é–2å€‹ï¼ˆå›ºå®šï¼‰
	var map_mult = 1.0
	
	if map_id != "" and GameConstants.TOLL_MAP_MULTIPLIER.has(map_id):
		map_mult = GameConstants.TOLL_MAP_MULTIPLIER[map_id]
	
	var raw_cost = base * element_mult * level_mult * chain_bonus * map_mult
	return GameConstants.floor_toll(raw_cost)
```

### Phase 3: land_command_ui.gd ã‚’ä¿®æ­£

**show_level_selection() - 183è¡Œ**
```gdscript
func show_level_selection(tile_index: int, current_level: int, player_magic: int):
	selected_tile_for_action = tile_index
	
	if action_menu_panel:
		action_menu_panel.visible = false
	
	if current_level_label:
		current_level_label.text = "ç¾åœ¨: Lv.%d" % current_level
	
	for level in [2, 3, 4, 5]:
		if level <= current_level:
			if level_selection_buttons.has(level):
				level_selection_buttons[level].disabled = true
		else:
			# TileDataManager ã‹ã‚‰è¨ˆç®—
			var cost = board_system_ref.tile_data_manager.calculate_level_up_cost(tile_index, level)
			var next_cost = board_system_ref.tile_data_manager.calculate_level_up_cost(tile_index, level) if level > current_level else 0
			
			# ç¾åœ¨ãƒ¬ãƒ™ãƒ«ã‹ã‚‰ã®å·®åˆ†ã‚’è¨ˆç®—
			var current_cost = board_system_ref.tile_data_manager.calculate_level_up_cost(tile_index, current_level) if current_level > 1 else 0
			var diff_cost = next_cost - current_cost
			
			if player_magic >= diff_cost:
				if level_selection_buttons.has(level):
					level_selection_buttons[level].disabled = false
					level_selection_buttons[level].text = "Lv.%d â†’ %dG" % [level, diff_cost]
			else:
				if level_selection_buttons.has(level):
					level_selection_buttons[level].disabled = true
					level_selection_buttons[level].text = "Lv.%d â†’ %dG (ä¸è¶³)" % [level, diff_cost]
```

**create_level_selection_panel() - 238è¡Œ**
```gdscript
func create_level_selection_panel(parent: Node):
	# ... ãƒ‘ãƒãƒ«ä½œæˆéƒ¨åˆ†ã¯æ—¢å­˜ã®ã¾ã¾ ...
	
	for level in [2, 3, 4, 5]:
		var btn = _create_level_button(level, 0, Vector2(10, button_y))
		btn.pressed.connect(_on_level_selected.bind(level))
		level_selection_panel.add_child(btn)
		level_selection_buttons[level] = btn
		button_y += 65 + button_spacing
```

**_calculate_level_up_cost() - 315è¡Œ**
```gdscript
func _calculate_level_up_cost(tile_index: int, from_level: int, to_level: int) -> int:
	# TileDataManager ã‹ã‚‰è¨ˆç®—çµæœã‚’å–å¾—
	if board_system_ref and board_system_ref.tile_data_manager:
		var to_cost = board_system_ref.tile_data_manager.calculate_level_up_cost(tile_index, to_level)
		var from_cost = board_system_ref.tile_data_manager.calculate_level_up_cost(tile_index, from_level) if from_level > 1 else 0
		return to_cost - from_cost
	return 0
```

---

## å®Ÿè£…ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³

### Step 1: GameConstants ã®ç¢ºèªãƒ»è¿½åŠ ï¼ˆ15åˆ†ï¼‰
- [ ] TOLL_* å®šæ•°ãŒæ—¢ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- [ ] floor_toll() é–¢æ•°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- [ ] TOLL_MAP_MULTIPLIER ã«ãƒãƒƒãƒ—ã‚’è¿½åŠ ï¼ˆå¾Œã§ï¼‰

### Step 2: TileDataManager.gd ã« calculate_level_up_cost() ã‚’è¿½åŠ ï¼ˆ30åˆ†ï¼‰
- [ ] ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…
- [ ] ãƒ†ã‚¹ãƒˆ: å„ãƒ¬ãƒ™ãƒ«ãƒ»å„å±æ€§ãƒ»å„ãƒãƒƒãƒ—ã§ã®è¨ˆç®—çµæœã‚’æ¤œè¨¼

### Step 3: land_command_ui.gd ã‚’ä¿®æ­£ï¼ˆ1æ™‚é–“ï¼‰
- [ ] show_level_selection() ã‚’ä¿®æ­£
- [ ] create_level_selection_panel() ã‚’ä¿®æ­£
- [ ] _calculate_level_up_cost() ã‚’ä¿®æ­£
- [ ] ãƒ†ã‚¹ãƒˆ: UIè¡¨ç¤ºãŒæ­£ã—ã„ã‹ç¢ºèª

### Step 4: TileActionProcessor.gd ã®ç¢ºèªï¼ˆ15åˆ†ï¼‰
- [ ] on_level_up_selected() ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã‹ç¢ºèªï¼ˆä¿®æ­£ä¸è¦ã®å¯èƒ½æ€§ãŒé«˜ã„ï¼‰

### Step 5: çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆ30åˆ†ï¼‰
- [ ] å„ã‚¿ã‚¤ãƒ«ã§ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ãŒæ­£ã—ãè¨ˆç®—ã•ã‚Œã‚‹ã‹
- [ ] ãƒãƒƒãƒ—ã”ã¨ã« ã‚³ã‚¹ãƒˆãŒç•°ãªã‚‹ã‹
- [ ] å±æ€§ã”ã¨ã«ã‚³ã‚¹ãƒˆãŒç•°ãªã‚‹ã‹
- [ ] 10ã®ä½ã§æ­£ã—ãåˆ‡ã‚Šæ¨ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã‹

---

## ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### å®Ÿè£…å‰ã®ç¢ºèª
- [ ] GameConstants ã« TOLL_* ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- [ ] floor_toll() ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- [ ] ç¾åœ¨ã®ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ã‚‹ã‹ç¢ºèª

### å®Ÿè£…æ™‚ã®ç¢ºèª
- [ ] calculate_level_up_cost() ã®è¨ˆç®—å¼ãŒæ­£ã—ã„ã‹
- [ ] ã‚¿ã‚¤ãƒ«ã®å±æ€§ã‚’æ­£ã—ãå–å¾—ã—ã¦ã„ã‚‹ã‹
- [ ] ãƒãƒƒãƒ—ä¿‚æ•°ã‚’æ­£ã—ãé©ç”¨ã—ã¦ã„ã‚‹ã‹
- [ ] 10ã®ä½ã§æ­£ã—ãåˆ‡ã‚Šæ¨ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã‹

### å®Ÿè£…å¾Œã®æ¤œè¨¼
- [ ] UIè¡¨ç¤ºãŒå¤‰ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆå€¤ãŒå‹•çš„ã«è¨ˆç®—ã•ã‚Œã¦ã„ã‚‹ï¼‰
- [ ] ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆãŒæ­£ç¢ºã«è¨ˆç®—ã•ã‚Œã‚‹ã‹
- [ ] ãƒãƒƒãƒ—ã”ã¨ã«ç•°ãªã‚‹ä¾¡æ ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹
- [ ] ç„¡å±æ€§ã‚¿ã‚¤ãƒ«ã§20%å®‰ã„ä¾¡æ ¼ã«ãªã‚‹ã‹

---

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- `docs/design/toll_system_spec.md` - é€šè¡Œæ–™ã‚·ã‚¹ãƒ†ãƒ ä»•æ§˜
- `docs/design/toll_system.md` - é€šè¡Œæ–™ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸
- `docs/refactoring/toll_system_refactoring.md` - é€šè¡Œæ–™ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°è¨ˆç”»
- `docs/design/level_up_cost_implementation_flow.md` - ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆå®Ÿè£…ãƒ•ãƒ­ãƒ¼

---

## å¤‰æ›´å±¥æ­´ï¼ˆ2025/11/23ï¼‰

### ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ: é€šè¡Œæ–™æ”¯æ‰•ã„å‡¦ç†ã®ä¸€æœ¬åŒ–ã«ä¼´ã†é€šçŸ¥

**ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¸ã®å½±éŸ¿**:
- âŒ ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ã‚³ã‚¹ãƒˆè¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ï¼šå¤‰æ›´ãªã—
- âŒ GameConstants ã®å®šæ•°ï¼šå¤‰æ›´ãªã—
- âŒ TileDataManager.calculate_level_up_cost()ï¼šå¤‰æ›´ãªã—
- âœ… å‚ç…§æƒ…å ±æ›´æ–°ï¼šé€šè¡Œæ–™æ”¯æ‰•ã„å‡¦ç†ãŒåˆ¥è¨­è¨ˆã«å¤‰æ›´ã•ã‚ŒãŸã“ã¨ã‚’è¨˜è¼‰

**å‚ç…§**: 
- [toll_system_spec.md](toll_system_spec.md) v2.2
- [toll_system.md](toll_system.md) v2.2

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ23æ—¥ï¼ˆä¿®æ­£: æ”¯æ‰•ã„å‡¦ç†ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰
