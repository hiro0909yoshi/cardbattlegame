# クリーチャー分裂・複製スキル設計書

## 概要

クリーチャーが特定条件で自身のコピーを盤面に配置するスキル。

## 対象クリーチャー

| ID | 名前 | トリガー | 効果 |
|---|---|---|---|
| 140 | マイコロン | 敵から攻撃を受けて生き残った戦闘後 | ランダムな空地に自分のコピーを配置 |
| 335 | バウダーイーター | 移動時 | 元のドミニオに自分を残し、移動先にコピーを配置 |

## 詳細仕様

### マイコロン (ID: 140)

**トリガー条件:**
- 防御側として戦闘に参加
- 敵の攻撃を受けた（ダメージを受けた）
- 戦闘後に生き残っている

**効果:**
- ランダムな空地を選択
- 自分のコピーを配置

**コピーのステータス:**
- base_up_ap: 引き継ぐ
- base_up_hp: 引き継ぐ
- current_hp: 引き継ぐ
- 刻印: 引き継がない

**発動条件:**
- 空地が存在すること（なければ発動しない）

---

### バウダーイーター (ID: 335)

**トリガー条件:**
- ドミニオオーダーから「移動」を選択して移動した時のみ
- スペルやアルカナアーツによる移動は対象外
- 天駆刻印付与がついている時のドミニオオーダー移動は対象（増殖する）

**効果:**
- 元のドミニオに自分が残る
- 移動先に自分のコピーが配置される

**元のドミニオ（残る方）:**
- base_up_ap: 維持
- base_up_hp: 維持
- current_hp: 維持
- 刻印: 維持（移動していないため）

**移動先（コピー）:**
- base_up_ap: 引き継ぐ
- base_up_hp: 引き継ぐ
- current_hp: 引き継ぐ
- 刻印: なし（新規配置扱い）

---

## 実装方針

### 新規クラス
- ファイル: `scripts/battle/skills/skill_creature_spawn.gd`
- クラス名: `SkillCreatureSpawn`

### 呼び出し元
- マイコロン: `skill_battle_end_effects.gd` または `battle_special_effects.gd`
- バウダーイーター: `tile_action_processor.gd` のドミニオオーダー移動処理
  - 通常移動: 元のドミニオからクリーチャー削除 → 移動先に配置
  - バウダーイーター: 元のドミニオにクリーチャー残す → 移動先にコピー配置
  - skill_creature_spawn.gd は「増殖メカニズム」のみ提供

### 共通処理
- クリーチャーデータのコピー生成
- ステータス引き継ぎ処理
- 刻印除去処理

### マイコロン専用
- 空地検索
- ランダム空地へのコピー配置

### バウダーイーター専用
- 元のドミニオにクリーチャーを残す処理
- 移動先の選択はドミニオオーダー移動に任せる

---

## JSON構造案

### マイコロン
```json
{
  "ability_parsed": {
	"effects": [
	  {
		"effect_type": "spawn_copy_on_defend_survive",
		"target": "random_empty_tile",
		"inherit": {
		  "base_up_ap": true,
		  "base_up_hp": true,
		  "current_hp": true,
		  "curse": false
		}
	  }
	]
  }
}
```

### バウダーイーター
```json
{
  "ability_parsed": {
	"effects": [
	  {
		"effect_type": "split_on_move",
		"description": "移動時に元のドミニオに自分を残す"
	  }
	]
  }
}
```

---

## 実装状況

- [x] ドキュメント作成
- [x] JSON定義
- [x] skill_creature_spawn.gd 作成
- [x] マイコロン実装
- [x] バウダーイーター実装
- [x] テスト完了

---

## 備考

- 武器/アイテムの引き継ぎ概念はない
- 空地がない場合は発動しない
