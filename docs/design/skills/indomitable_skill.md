# 不屈スキル

**バージョン**: 1.0  
**最終更新**: 2025年10月24日

---

## 📋 目次

1. [概要](#概要)
2. [発動条件](#発動条件)
3. [効果](#効果)
4. [戦略的価値](#戦略的価値)
5. [実装クリーチャー](#実装クリーチャー)
6. [データ構造](#データ構造)
7. [実装コード](#実装コード)
8. [使用例](#使用例)
9. [設計思想](#設計思想)

---

## 概要

アクション（召喚、レベルアップ、移動、交換）実行後もダウン状態にならないパッシブスキル。何度でも領地コマンドを実行可能。

---

## 発動条件

- 無条件発動（不屈持ちクリーチャーがいる土地は常にダウンしない）

---

## 効果

- **召喚後**: 通常はダウンするが、不屈持ちはダウンしない
- **レベルアップ後**: 通常はダウンするが、不屈持ちはダウンしない
- **移動後**: 移動先の土地が通常はダウンするが、不屈持ちはダウンしない
- **交換後**: 通常はダウンするが、不屈持ちはダウンしない

---

## 戦略的価値

- **連続行動**: 同一ターンに複数回領地コマンドを実行可能

---

## 実装クリーチャー

### 実装済み（16体）

| ID | 名前 | 属性 | AP | HP |
|----|------|------|----|----|
| 14 | シールドメイデン | 火 | 20 | 50 |
| 18 | ショッカー | 火 | 20 | 30 |
| 28 | バードメイデン | 火 | 10 | 40 |
| 113 | エキノダーム | 水 | 20 | 40 |
| 117 | カワヒメ | 水 | 20 | 40 |
| 141 | マカラ | 水 | 30 | 40 |
| 207 | キャプテンコック | 地 | 30 | 40 |
| 234 | ヒーラー | 地 | 10 | 40 |
| 235 | ピクシー | 地 | 30 | 30 |
| 249 | ワーベア | 地 | 30 | 50 |
| 312 | グレートニンバス | 風 | 30 | 30 |
| 331 | トレジャーレイダー | 風 | 30 | 30 |
| 341 | マーシャルモンク | 風 | 30 | 40 |
| 342 | マッドハーレクイン | 風 | 20 | 40 |
| 403 | アーキビショップ | 無 | 20 | 40 |
| 418 | シャドウガイスト | 無 | 30 | 30 |

---

## データ構造

```json
{
  "ability_detail": "不屈",
  "ability_parsed": {
	"keywords": ["不屈"]
  }
}
```

---

## 実装コード

### SkillSystem.gd
```gdscript
## 不屈スキルを持っているかチェック
static func has_unyielding(creature_data: Dictionary) -> bool:
	if creature_data.is_empty():
		return false
	
	var ability_detail = creature_data.get("ability_detail", "")
	return "不屈" in ability_detail
```

### TileActionProcessor.gd（召喚時）
```gdscript
# Phase 1-A: 召喚後にダウン状態を設定（不屈チェック）
if board_system.tile_nodes.has(current_tile):
	var tile = board_system.tile_nodes[current_tile]
	if tile and tile.has_method("set_down_state"):
		# 不屈持ちでなければダウン状態にする
		if not SkillSystem.has_unyielding(card_data):
			tile.set_down_state(true)
		else:
			print("不屈により召喚後もダウンしません")
```

### LandCommandHandler.gd（レベルアップ時）
```gdscript
# ダウン状態設定（不屈チェック）
if tile.has_method("set_down_state"):
	var creature = tile.creature_data if tile.has("creature_data") else {}
	if not SkillSystem.has_unyielding(creature):
		tile.set_down_state(true)
	else:
		print("不屈によりレベルアップ後もダウンしません")
```

---

## 使用例

### シナリオ1: 連続レベルアップ
```
1. ターン開始時、シールドメイデン配置のLv.1土地を所有（魔力: 1200G）
2. 領地コマンド → レベルアップ → Lv.2（80G消費）
3. 不屈により土地はダウンしない
4. 再度領地コマンド → レベルアップ → Lv.3（160G消費）
5. さらに領地コマンド → レベルアップ → Lv.5（580G消費）
6. 合計820G消費で、1ターンでLv.5達成！
```

### シナリオ2: 防衛拠点
```
1. 重要な場所にワーベア（不屈）配置
2. 敵に攻撃される → バトル勝利
3. 通常ならダウンするが、不屈により領地コマンド可能
4. 即座にレベルアップして防御力強化
5. 次の敵にも備えられる
```

---

## 設計思想

- **リソース管理**: 魔力さえあれば強力だが、魔力切れに注意
- **戦略性**: 不屈持ちクリーチャーの配置場所が重要
- **バランス**: ダウンシステムの制約を回避できる唯一のスキル

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|---------|
| 2025/10/24 | 1.0 | 個別ドキュメントとして分離 |
