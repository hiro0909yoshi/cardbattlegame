# å³æ­»ã‚¹ã‚­ãƒ«

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0  
**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ24æ—¥

---

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ç™ºå‹•ã‚¿ã‚¤ãƒŸãƒ³ã‚°](#ç™ºå‹•ã‚¿ã‚¤ãƒŸãƒ³ã‚°)
3. [ç™ºå‹•æ¡ä»¶](#ç™ºå‹•æ¡ä»¶)
4. [åŠ¹æœ](#åŠ¹æœ)
5. [æ¡ä»¶ã‚¿ã‚¤ãƒ—](#æ¡ä»¶ã‚¿ã‚¤ãƒ—)
6. [å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼](#å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼)
7. [é©ç”¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°](#é©ç”¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°)
8. [ä»–ã‚¹ã‚­ãƒ«ã¨ã®ç›¸äº’ä½œç”¨](#ä»–ã‚¹ã‚­ãƒ«ã¨ã®ç›¸äº’ä½œç”¨)
9. [å®Ÿè£…ã‚³ãƒ¼ãƒ‰](#å®Ÿè£…ã‚³ãƒ¼ãƒ‰)
10. [ä½¿ç”¨ä¾‹](#ä½¿ç”¨ä¾‹)
11. [è¨­è¨ˆæ€æƒ³](#è¨­è¨ˆæ€æƒ³)

---

## æ¦‚è¦

æ”»æ’ƒå¾Œã€ä¸€å®šç¢ºç‡ã§ç›¸æ‰‹ã‚’å³æ­»ã•ã›ã‚‹ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¹ã‚­ãƒ«ã€‚

---

## ç™ºå‹•ã‚¿ã‚¤ãƒŸãƒ³ã‚°

- **æ”»æ’ƒå¾Œã€ãƒ€ãƒ¡ãƒ¼ã‚¸é©ç”¨å¾Œ**ã«å³æ­»åˆ¤å®š
- æ”»æ’ƒãŒç„¡åŠ¹åŒ–ã•ã‚ŒãŸå ´åˆã¯ç™ºå‹•ã—ãªã„
- å„æ”»æ’ƒã”ã¨ã«åˆ¤å®šï¼ˆ2å›æ”»æ’ƒãªã‚‰2å›åˆ¤å®šï¼‰

---

## ç™ºå‹•æ¡ä»¶

- å³æ­»ã‚¹ã‚­ãƒ«ä¿æŒ
- æ¡ä»¶ã‚’æº€ãŸã™ï¼ˆå±æ€§ã€APã€ç«‹å ´ãªã©ï¼‰
- ç¢ºç‡åˆ¤å®šæˆåŠŸ

---

## åŠ¹æœ

- å³æ­»æˆåŠŸæ™‚ã€ç›¸æ‰‹ã®`instant_death_flag = true`
- ç›¸æ‰‹ã®HPã‚’0ã«ã™ã‚‹
- **å†ç”Ÿãƒ»å¾©æ´»ãƒ»å¤‰èº«ã‚¹ã‚­ãƒ«ã¯ç™ºå‹•ä¸å¯**

---

## æ¡ä»¶ã‚¿ã‚¤ãƒ—

### 1. ç„¡æ¡ä»¶å³æ­»

```json
{
  "ability_parsed": {
	"keywords": ["å³æ­»"],
	"keyword_conditions": {
	  "å³æ­»": {
		"condition_type": "none",
		"probability": 70
	  }
	}
  }
}
```

**å®Ÿè£…ä¾‹**:
- ã‚¢ãƒã‚¤ãƒãƒ–ãƒ« (ID: 201) - å¾Œæ‰‹ï¼›å³æ­»[70%]

---

### 2. æ•µå±æ€§æ¡ä»¶

```json
{
  "ability_parsed": {
	"keywords": ["å³æ­»"],
	"keyword_conditions": {
	  "å³æ­»": {
		"condition_type": "enemy_is_element",
		"elements": "fire",
		"probability": 60
	  }
	}
  }
}
```

**å®Ÿè£…ä¾‹**:
- ã‚¤ã‚¨ãƒ†ã‚£ (ID: 111) - å³æ­»[ç«ãƒ»60%]
- ãƒ€ãƒ³ãƒ”ãƒ¼ãƒ« (ID: 325) - å³æ­»[åœ°ãƒ»60%]
- ã‚»ã‚¤ãƒ³ãƒˆ (ID: 424) - å³æ­»[ç„¡ãƒ»100%]

**ç‰¹æ®Šã‚±ãƒ¼ã‚¹**:
- `elements: "å…¨"` - ã™ã¹ã¦ã®å±æ€§ã«æœ‰åŠ¹
- ã‚­ãƒ­ãƒãƒƒã‚¯ã‚¹ (ID: 118) - é˜²å¾¡å´ãªã‚‰å³æ­»[å…¨ãƒ»80%]

---

### 3. é˜²å¾¡å´APæ¡ä»¶

```json
{
  "ability_parsed": {
	"keywords": ["å³æ­»"],
	"keyword_conditions": {
	  "å³æ­»": {
		"condition_type": "defender_ap_check",
		"operator": ">=",
		"value": 50,
		"probability": 60
	  }
	}
  }
}
```

**å®Ÿè£…ä¾‹**:
- ã‚·ã‚°ãƒ«ãƒ‰ (ID: 16) - å³æ­»[AP50ä»¥ä¸Šãƒ»60%]

**èª¬æ˜**: ç›¸æ‰‹ï¼ˆé˜²å¾¡å´ï¼‰ã®åŸºæœ¬APãŒ50ä»¥ä¸Šã®å ´åˆã«å³æ­»åˆ¤å®š

---

### 4. ä½¿ç”¨è€…ãŒé˜²å¾¡å´æ¡ä»¶

```json
{
  "ability_parsed": {
	"keywords": ["å³æ­»"],
	"keyword_conditions": {
	  "å³æ­»": {
		"condition_type": "defender_role",
		"elements": "å…¨",
		"probability": 80
	  }
	}
  }
}
```

**å®Ÿè£…ä¾‹**:
- ã‚­ãƒ­ãƒãƒƒã‚¯ã‚¹ (ID: 118) - é˜²å¾¡å´ãªã‚‰å³æ­»[å…¨ãƒ»80%]

**èª¬æ˜**: ã‚­ãƒ­ãƒãƒƒã‚¯ã‚¹ãŒé˜²å¾¡å´ã®æ™‚ã®ã¿ã€åæ’ƒæ™‚ã«å³æ­»åˆ¤å®š

---

## å®Ÿè£…ã‚¯ãƒªãƒ¼ãƒãƒ£ãƒ¼

### å®Ÿè£…æ¸ˆã¿ï¼ˆ6ä½“ï¼‰

| ID | åå‰ | å±æ€§ | æ¡ä»¶ | ç¢ºç‡ |
|----|------|------|------|-----|
| 16 | ã‚·ã‚°ãƒ«ãƒ‰ | ç« | é˜²å¾¡å´APâ‰¥50 | 60% |
| 415 | ã‚µãƒ ãƒ©ã‚¤ | ç„¡ | é˜²å¾¡å´APâ‰¥40 | 70% |
| 111 | ã‚¤ã‚¨ãƒ†ã‚£ | æ°´ | æ•µãŒç«å±æ€§ | 60% |
| 118 | ã‚­ãƒ­ãƒãƒƒã‚¯ã‚¹ | æ°´ | é˜²å¾¡å´ãªã‚‰ | 80% |
| 201 | ã‚¢ãƒã‚¤ãƒãƒ–ãƒ« | åœ° | ç„¡æ¡ä»¶ï¼ˆå¾Œæ‰‹ï¼‰ | 70% |
| 325 | ãƒ€ãƒ³ãƒ”ãƒ¼ãƒ« | é¢¨ | æ•µãŒåœ°å±æ€§ | 60% |
| 424 | ã‚»ã‚¤ãƒ³ãƒˆ | ç„¡ | æ•µãŒç„¡å±æ€§ | 100% |

---

## é©ç”¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°

- **é–¢æ•°**: `BattleSystem._check_instant_death()`
- **ã‚¿ã‚¤ãƒŸãƒ³ã‚°**: æ”»æ’ƒå¾Œã€ãƒ€ãƒ¡ãƒ¼ã‚¸é©ç”¨å¾Œã€æ­»äº¡ãƒã‚§ãƒƒã‚¯å‰
- **åˆ¤å®š**: åŸºæœ¬APã§æ¡ä»¶åˆ¤å®šï¼ˆè¨ˆç®—å¾Œã®APã§ã¯ãªã„ï¼‰

---

## ä»–ã‚¹ã‚­ãƒ«ã¨ã®ç›¸äº’ä½œç”¨

| ã‚¹ã‚­ãƒ« | é–¢ä¿‚ |
|--------|------|
| ç„¡åŠ¹åŒ– | å³æ­»ã‚’ç„¡åŠ¹åŒ–ã§ãã‚‹ï¼ˆå°†æ¥å®Ÿè£…ï¼‰ |
| å†ç”Ÿ | å³æ­»ã•ã‚ŒãŸã‚‰å†ç”Ÿä¸å¯ |
| å¾©æ´» | å³æ­»ã•ã‚ŒãŸã‚‰å¾©æ´»ä¸å¯ï¼ˆå°†æ¥å®Ÿè£…ï¼‰ |
| å¤‰èº« | å³æ­»ã•ã‚ŒãŸã‚‰å¤‰èº«ä¸å¯ï¼ˆå°†æ¥å®Ÿè£…ï¼‰ |
| å…ˆåˆ¶ | å…ˆåˆ¶æŒã¡ãŒå³æ­»ã‚’æŒã¤å ´åˆã€å…ˆåˆ¶æ”»æ’ƒæ™‚ã«å³æ­»åˆ¤å®š |
| 2å›æ”»æ’ƒ | å„æ”»æ’ƒã”ã¨ã«å³æ­»åˆ¤å®š |

---

## å®Ÿè£…ã‚³ãƒ¼ãƒ‰

```gdscript
func _check_instant_death(attacker: BattleParticipant, defender: BattleParticipant) -> bool:
	# å³æ­»ã‚¹ã‚­ãƒ«ã‚’æŒã¤ã‹ãƒã‚§ãƒƒã‚¯
	var ability_parsed = attacker.creature_data.get("ability_parsed", {})
	var keywords = ability_parsed.get("keywords", [])
	
	if not "å³æ­»" in keywords:
		return false
	
	# å³æ­»æ¡ä»¶ã‚’å–å¾—
	var keyword_conditions = ability_parsed.get("keyword_conditions", {})
	var instant_death_condition = keyword_conditions.get("å³æ­»", {})
	
	# æ¡ä»¶ãƒã‚§ãƒƒã‚¯
	if not _check_instant_death_condition(instant_death_condition, attacker, defender):
		return false
	
	# ç¢ºç‡åˆ¤å®š
	var probability = instant_death_condition.get("probability", 0)
	var random_value = randf() * 100.0
	
	if random_value <= probability:
		print("ã€å³æ­»ç™ºå‹•ã€‘", attacker.creature_data.get("name", "?"), 
			  " â†’ ", defender.creature_data.get("name", "?"), 
			  " (", probability, "% åˆ¤å®šæˆåŠŸ)")
		defender.instant_death_flag = true
		defender.current_hp = 0
		return true
	else:
		print("ã€å³æ­»å¤±æ•—ã€‘ç¢ºç‡:", probability, "% åˆ¤å®šå€¤:", int(random_value), "%")
		return false
```

---

## ä½¿ç”¨ä¾‹

### ãƒãƒˆãƒ«ãƒ•ãƒ­ãƒ¼ï¼ˆã‚¤ã‚¨ãƒ†ã‚£ vs ãƒ•ã‚¡ã‚¤ã‚¢ãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¯ï¼‰

```
ä¾µç•¥å´: ã‚¤ã‚¨ãƒ†ã‚£ AP:40 HP:40 (å³æ­»[ç«ãƒ»60%])
é˜²å¾¡å´: ãƒ•ã‚¡ã‚¤ã‚¢ãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¯ AP:30 HP:50 (ç«å±æ€§)

ã€ç¬¬1æ”»æ’ƒã€‘ä¾µç•¥å´ã®æ”»æ’ƒ
  ã‚¤ã‚¨ãƒ†ã‚£ AP:40 â†’ ãƒ•ã‚¡ã‚¤ã‚¢ãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¯
  ãƒ€ãƒ¡ãƒ¼ã‚¸å‡¦ç†:
	- åœŸåœ°ãƒœãƒ¼ãƒŠã‚¹: 10 æ¶ˆè²»
	- åŸºæœ¬HP: 30 æ¶ˆè²»
  â†’ æ®‹HP: 10 (åŸºæœ¬HP:10)

ã€å³æ­»åˆ¤å®šé–‹å§‹ã€‘ã‚¤ã‚¨ãƒ†ã‚£ â†’ ãƒ•ã‚¡ã‚¤ã‚¢ãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¯
ã€å³æ­»æ¡ä»¶ã€‘æ•µãŒfireå±æ€§ â†’ æ¡ä»¶æº€ãŸã™
ã€å³æ­»ç™ºå‹•ã€‘ã‚¤ã‚¨ãƒ†ã‚£ â†’ ãƒ•ã‚¡ã‚¤ã‚¢ãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¯ (60% åˆ¤å®šæˆåŠŸ)
  â†’ ãƒ•ã‚¡ã‚¤ã‚¢ãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¯ æ’ƒç ´ï¼

ã€çµæœã€‘ä¾µç•¥æˆåŠŸï¼ˆãƒ•ã‚¡ã‚¤ã‚¢ãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¯ã¯åæ’ƒã§ããšï¼‰
```

---

## è¨­è¨ˆæ€æƒ³

- **ãƒã‚¤ãƒªã‚¹ã‚¯ãƒ»ãƒã‚¤ãƒªã‚¿ãƒ¼ãƒ³**: ç¢ºç‡ç™ºå‹•ã ãŒã€æˆåŠŸã™ã‚Œã°ä¸€æ’ƒå¿…æ®º
- **æ¡ä»¶ä»˜ãç™ºå‹•**: ç„¡æ¡ä»¶å³æ­»ã¯å°‘ãªãã€ã»ã¨ã‚“ã©ãŒæ¡ä»¶ä»˜ã
- **å°†æ¥ã®æ‹¡å¼µæ€§**: `instant_death_flag`ã«ã‚ˆã‚Šã€å³æ­»å›é¿ã‚¹ã‚­ãƒ«å®Ÿè£…ãŒå®¹æ˜“
- **ãƒãƒ©ãƒ³ã‚¹èª¿æ•´**: ç¢ºç‡ã¨æ¡ä»¶ã«ã‚ˆã‚Šã€å¼·åŠ›ã™ããªã„ã‚ˆã†ã«èª¿æ•´

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|-----------|---------|
| 2025/10/24 | 1.0 | å€‹åˆ¥ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã—ã¦åˆ†é›¢ |
